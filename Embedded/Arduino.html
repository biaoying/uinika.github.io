<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#8C634F">
<meta name="generator" content="Hexo 4.2.1">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/favicon.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon.png">
  <link rel="mask-icon" href="/images/favicon.png" color="#8C634F">
  <meta http-equiv="Cache-Control" content="no-transform">
  <meta http-equiv="Cache-Control" content="no-siteapp">

<link rel="stylesheet" href="/css/main.css">

<link rel="stylesheet" href="//fonts.googleapis.com/css?family=Lato:300,300italic,400,400italic,700,700italic|Monda:300,300italic,400,400italic,700,700italic|Source+Code+Pro:300,300italic,400,400italic,700,700italic&display=swap&subset=latin,latin-ext">
<link rel="stylesheet" href="/lib/font-awesome/css/font-awesome.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"uinika.github.io","root":"/","scheme":"Gemini","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":true,"show_result":true,"style":"flat"},"back2top":{"enable":true,"sidebar":true,"scrollpercent":true},"bookmark":{"enable":true,"color":"#A38272","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":true},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},"path":"search.xml"};
  </script>

  <meta name="description" content="Arduino 是一款目前非常成熟的物联网产品原型开发工具，其硬件设计、IDE 工具、微控制器核心库皆基于开源协议发布，其中，Eagle 原理图以及 PCB 布线遵循 Creative Commons Attribution Share-Alike 许可，而 IDE 环境的源代码基于 GPL 协议，微控制器的 C&#x2F;C++ 库则是基于 LGPL 协议。自从 2005 年首块 Arduino 开发板发">
<meta property="og:type" content="article">
<meta property="og:title" content="玩转 Arduino Uno、Mega、Due 开源硬件">
<meta property="og:url" content="https://uinika.github.io/Embedded/Arduino.html">
<meta property="og:site_name" content="Bit by bit">
<meta property="og:description" content="Arduino 是一款目前非常成熟的物联网产品原型开发工具，其硬件设计、IDE 工具、微控制器核心库皆基于开源协议发布，其中，Eagle 原理图以及 PCB 布线遵循 Creative Commons Attribution Share-Alike 许可，而 IDE 环境的源代码基于 GPL 协议，微控制器的 C&#x2F;C++ 库则是基于 LGPL 协议。自从 2005 年首块 Arduino 开发板发">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://uinika.github.io/Embedded/Arduino/logo.png">
<meta property="og:image" content="https://uinika.github.io/Embedded/Arduino/Driver/Uno.jpg">
<meta property="og:image" content="https://uinika.github.io/Embedded/Arduino/Driver/CH340G.png">
<meta property="og:image" content="https://uinika.github.io/Embedded/Arduino/Driver/Success.png">
<meta property="og:image" content="https://uinika.github.io/Embedded/Arduino/IDE/Step-1.png">
<meta property="og:image" content="https://uinika.github.io/Embedded/Arduino/IDE/Step-2.png">
<meta property="og:image" content="https://uinika.github.io/Embedded/Arduino/IDE/Step-3.png">
<meta property="og:image" content="https://uinika.github.io/Embedded/Arduino/IDE/Step-4.png">
<meta property="og:image" content="https://uinika.github.io/Embedded/Arduino/IDE/Step-5.png">
<meta property="og:image" content="https://uinika.github.io/Embedded/Arduino/IDE/PlatformIO.png">
<meta property="og:image" content="https://uinika.github.io/Embedded/Arduino/Pin/diagram-1.png">
<meta property="og:image" content="https://uinika.github.io/Embedded/Arduino/Pin/diagram-2.png">
<meta property="og:image" content="https://uinika.github.io/Embedded/Arduino/Pin/diagram-3.png">
<meta property="og:image" content="https://uinika.github.io/Embedded/Arduino/Pin/serial-print.png">
<meta property="og:image" content="https://uinika.github.io/Embedded/Arduino/Pin/PWM.gif">
<meta property="og:image" content="https://uinika.github.io/Embedded/Arduino/Pin/DSO.gif">
<meta property="og:image" content="https://uinika.github.io/Embedded/Arduino/Data-Type/static.png">
<meta property="og:image" content="https://uinika.github.io/Embedded/Arduino/Data-Type/PROGMEM.png">
<meta property="og:image" content="https://uinika.github.io/Embedded/Arduino/Data-Type/array-traversal.png">
<meta property="og:image" content="https://uinika.github.io/Embedded/Arduino/Data-Type/length.png">
<meta property="og:image" content="https://uinika.github.io/Embedded/Arduino/Update/0.png">
<meta property="og:image" content="https://uinika.github.io/Embedded/Arduino/Update/1.png">
<meta property="og:image" content="https://uinika.github.io/Embedded/Arduino/Update/2.png">
<meta property="og:image" content="https://uinika.github.io/Embedded/Arduino/Update/3.png">
<meta property="og:image" content="https://uinika.github.io/Embedded/Arduino/Update/4.png">
<meta property="og:image" content="https://uinika.github.io/Embedded/Arduino/Update/5.png">
<meta property="og:image" content="https://uinika.github.io/Embedded/Arduino/ESP8266/1.png">
<meta property="og:image" content="https://uinika.github.io/Embedded/Arduino/ESP8266/2.png">
<meta property="og:image" content="https://uinika.github.io/Embedded/Arduino/ESP8266/3.png">
<meta property="og:image" content="https://uinika.github.io/Embedded/Arduino/ESP8266/4.png">
<meta property="og:image" content="https://uinika.github.io/Embedded/Arduino/Mega/0.jpg">
<meta property="og:image" content="https://uinika.github.io/Embedded/Arduino/Mega/1.png">
<meta property="og:image" content="https://uinika.github.io/Embedded/Arduino/Mega/2.png">
<meta property="og:image" content="https://uinika.github.io/Embedded/Arduino/Mega/3.png">
<meta property="og:image" content="https://uinika.github.io/Embedded/Arduino/Mega/4.png">
<meta property="og:image" content="https://uinika.github.io/Embedded/Arduino/Due/1.jpg">
<meta property="article:published_time" content="2020-05-21T13:39:03.426Z">
<meta property="article:modified_time" content="2020-05-21T13:39:03.426Z">
<meta property="article:author" content="Hank">
<meta property="article:tag" content="MCU">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://uinika.github.io/Embedded/Arduino/logo.png">

<link rel="canonical" href="https://uinika.github.io/Embedded/Arduino.html">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : false,
    isPost : true,
    lang   : 'zh-CN'
  };
</script>

  <title>玩转 Arduino Uno、Mega、Due 开源硬件 | Bit by bit</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

<link rel="alternate" href="/atom.xml" title="Bit by bit" type="application/atom+xml">
</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">Bit by bit</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
      <p class="site-subtitle" itemprop="description">Electronics, Embedded & Web</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-fw fa-th-large"></i>首页</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-fw fa-archive"></i>归档<span class="badge">53</span></a>

  </li>
        <li class="menu-item menu-item-about">

    <a href="/about/" rel="section"><i class="fa fa-fw fa-user"></i>关于</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="fa fa-fw fa-tags"></i>标签<span class="badge">22</span></a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories/" rel="section"><i class="fa fa-fw fa-briefcase"></i>分类<span class="badge">11</span></a>

  </li>
        <li class="menu-item menu-item-it圈">

    <a href="/industry/" rel="section"><i class="fa fa-fw fa-microchip"></i>IT圈</a>

  </li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>搜索
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup">
        <div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off"
           placeholder="搜索..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div id="search-result">
  <div id="no-result">
    <i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>
  </div>
</div>

    </div>
  </div>

</div>
    </header>

    
  <div class="reading-progress-bar"></div>
  <a role="button" class="book-mark-link book-mark-link-fixed"></a>

  <a href="https://github.com/uinika" class="github-corner" title="Follow me on GitHub" aria-label="Follow me on GitHub" rel="noopener" target="_blank"><svg width="80" height="80" viewBox="0 0 250 250" aria-hidden="true"><path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"></path></svg></a>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content post posts-expand">
            

    
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://uinika.github.io/Embedded/Arduino.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.png">
      <meta itemprop="name" content="Hank">
      <meta itemprop="description" content="My world of IT, learn it & play it.">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Bit by bit">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          玩转 Arduino Uno、Mega、Due 开源硬件
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2020-05-21 21:39:03" itemprop="dateCreated datePublished" datetime="2020-05-21T21:39:03+08:00">2020-05-21</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Embedded/" itemprop="url" rel="index"><span itemprop="name">Embedded</span></a>
                </span>
            </span>

          
            <span class="post-meta-item" title="阅读次数" id="busuanzi_container_page_pv" style="display: none;">
              <span class="post-meta-item-icon">
                <i class="fa fa-eye"></i>
              </span>
              <span class="post-meta-item-text">阅读次数：</span>
              <span id="busuanzi_value_page_pv"></span>
            </span>
            <span class="post-meta-item" title="本文字数">
              <span class="post-meta-item-icon">
                <i class="fa fa-file-word-o"></i>
              </span>
                <span class="post-meta-item-text">本文字数：</span>
              <span>26k</span>
            </span>
            <span class="post-meta-item" title="阅读时长">
              <span class="post-meta-item-icon">
                <i class="fa fa-clock-o"></i>
              </span>
                <span class="post-meta-item-text">阅读时长 &asymp;</span>
              <span>23 分钟</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
        <p><a href="https://www.arduino.cc/" target="_blank" rel="noopener"><strong>Arduino</strong></a> 是一款目前非常成熟的物联网产品原型开发工具，其硬件设计、IDE 工具、微控制器核心库皆基于开源协议发布，其中，<strong>Eagle</strong> 原理图以及 PCB 布线遵循 <code>Creative Commons Attribution Share-Alike</code> 许可，而 IDE 环境的源代码基于 <code>GPL</code> 协议，微控制器的 C/C++ 库则是基于 <code>LGPL</code> 协议。自从 2005 年首块 Arduino 开发板发布以来，已经推出了众多满足不同需求的硬件以及软件库，开源社区也日渐活跃与丰富。</p>
<p><img src="/Embedded/Arduino/logo.png"></p>
<p><strong>Arduino Uno</strong> 是整个 Arduino 家族当中使用最为广泛、文档最为齐全的一款硬件产品，基于 Microchip 微芯公司的 <strong>8</strong> 位 <strong>AVR</strong> 单片机 <a href="http://ww1.microchip.com/downloads/en/DeviceDoc/Atmel-7810-Automotive-Microcontrollers-ATmega328P_Datasheet.pdf" target="_blank" rel="noopener"><strong>ATmega328P</strong></a>，工作电压为<code>5V</code>，采用<code>16MHz</code>的无源谐振器，并拥有<code>32 KB</code>的 <strong>Flash</strong> 存储器（其中<code>0.5KB</code>用于<code>Bootloader</code>程序），以及<code>2KB</code>的 <strong>SRAM</strong> 和<code>1KB</code>的 <strong>EEPROM</strong>。本文采用的 Arduino 硬件是于 2011 年发布的 <a href="https://store.arduino.cc/usa/arduino-uno-rev3" target="_blank" rel="noopener"><strong>Arduino Uno R3</strong></a> 版本，是当前国内市场运用最为广泛的一款型号。</p>
<a id="more"></a>
<h2 id="安装驱动程序">安装驱动程序</h2>
<p>笔者手中的 <a href="https://store.arduino.cc/usa/arduino-uno-rev3" target="_blank" rel="noopener">Arduino Uno R3</a> 属于国产版本，将官方电路设计中用作 USB 转串口用途的<code>ATMEGA16U2</code>芯片替换为了江苏沁恒的<code>CH340G</code>芯片。</p>
<p><img src="/Embedded/Arduino/Driver/Uno.jpg"></p>
<p>因此，不能够使用 Arduino 官方推荐的驱动程序，而应该安装<a href="http://www.wch.cn/products/CH340.html" target="_blank" rel="noopener">CH340G 驱动程序</a>，从而确保计算机与开发板的正确连接。</p>
<p><img src="/Embedded/Arduino/Driver/CH340G.png"></p>
<p>安装完成之后，用<code>USB cable type A/B</code>数据线连接开发板与计算机，如果计算机的【设备管理器】当中显示<code>USB-SERIAL CH340 (COMx)</code>，就表示 Arduino 开发板已经连接成功。</p>
<p><img src="/Embedded/Arduino/Driver/Success.png"></p>
<h2 id="arduino-ide">Arduino IDE</h2>
<p>从官方网站下载<a href="https://www.arduino.cc/en/Main/Software" target="_blank" rel="noopener">Arduino IDE</a>并且安装，打开后依次选择<code>【文件 &gt; 示例 &gt; 01.Basics &gt; Blink】</code>：</p>
<p><img src="/Embedded/Arduino/IDE/Step-1.png"></p>
<p>然后再依次点击<code>【工具 &gt; 开发板 &gt; Arduino UNO】</code>选择当前所使用的 Arduino 开发板型号：</p>
<p><img src="/Embedded/Arduino/IDE/Step-2.png"></p>
<p>最后点击<code>【工具 &gt; 端口 &gt; COMx】</code>选择当前开发板所使用的串行端口，由于<code>COM1</code>和<code>COM2</code>通常被计算机保留给内部硬件串行设备值使用，因此外接串行设备的端口号通常会大于或等于<code>COM3</code>：</p>
<p><img src="/Embedded/Arduino/IDE/Step-3.png"></p>
<blockquote>
<p><strong>注意</strong>：如果无法确定当前 Arduino 硬件占用的串行端口号码，可以先拔出 USB 连接线，然后再重新插入，此时 IDE 端口设置中新增加的就是 Arduino 硬件的串口号码。</p>
</blockquote>
<p>接下来，验证当前程序是否存在语法错误，鼠标点击 Arduino IDE 右上角的<code>✔</code>编译验证按钮，或者依次选择菜单栏上的<code>【项目 &gt; 验证/编译】</code>，当然也可以直接按下快捷键<code>【Ctrl + R】</code>：</p>
<p><img src="/Embedded/Arduino/IDE/Step-4.png"></p>
<p>最后，编译并且上传程序至 Arduino 开发板，鼠标点击 Arduino IDE 右上角的<code>➨</code>上传按钮，或者依次选择菜单栏上的<code>【项目 &gt; 上传】</code>，当然也可以直接按下快捷键<code>【Ctrl + U】</code>：</p>
<p><img src="/Embedded/Arduino/IDE/Step-5.png"></p>
<p>程序上传完成之后将会被 Arduino 开发板自动运行，此时网络标号为<code>L</code>的 LED 将会间隔<code>1</code>秒钟不断闪烁，下面就是本示例里所运行的 <strong>Blink</strong> 的源代码：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 设置函数，只在按下重置或者电源按钮以后被运行一次。</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">setup</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  <span class="built_in">pinMode</span>(<span class="literal">LED_BUILTIN</span>, <span class="literal">OUTPUT</span>);      <span class="comment">// 初始化数字引脚 LED_BUILTIN 为输出模式</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 循环函数，永远循环执行里面的功能代码。</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">loop</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  <span class="built_in">digitalWrite</span>(<span class="literal">LED_BUILTIN</span>, <span class="literal">HIGH</span>);   <span class="comment">// 打开 LED，其中的 HIGH 表示高电平</span></span><br><span class="line">  <span class="built_in">delay</span>(<span class="number">1000</span>);                       <span class="comment">// 等待 1 秒钟</span></span><br><span class="line">  <span class="built_in">digitalWrite</span>(<span class="literal">LED_BUILTIN</span>, <span class="literal">LOW</span>);    <span class="comment">// 关闭 LED，其中的 LOW 表示低电平</span></span><br><span class="line">  <span class="built_in">delay</span>(<span class="number">1000</span>);                       <span class="comment">// 等待 1 秒钟</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>实际上，由于 Arduno 官方提供的 IDE 开发体验较差，所以也可以尝试使用基于 VSCode 的<a href="https://platformio.org/" target="_blank" rel="noopener">PlatformIO</a>插件来代替，这是一款可以方便的用于各类嵌入式、物联网产品开发的插件，具备跨平台的构建系统、库管理器，并提供了对 Arduino、ARM mbed、ESP8266/ESP32、AVR、RISC-V、STM32、PIC32、nRF51/nRF52、MSP430、MCS-51(8051)、FPGA、FreeRTOS、ESP-IDF、CMSIS、SPL 等众多平台的全面支持。</p>
<p><img src="/Embedded/Arduino/IDE/PlatformIO.png"></p>
<h2 id="avr-存储空间">AVR 存储空间</h2>
<p>除了基于 ARM 架构的 <strong>Arduino Due</strong> 之外，所有基于 AVR 架构的微控制器都具备如下 3 种片上存储空间：</p>
<ul>
<li><strong>Flash</strong>：程序存储空间，即保存 Arduino Sketch 程序的位置；</li>
<li><strong>SRAM</strong>：静态随机读取存储器，Arduino Sketch 程序运行时建立和操作变量的地方；</li>
<li><strong>EEPROM</strong>：供开发人员通过调用<a href="https://www.arduino.cc/en/Reference/EEPROM" target="_blank" rel="noopener">EEPROM 库</a>，从而持久保存数据的空间。</li>
</ul>
<blockquote>
<p><strong>注意</strong>：Flash 和 EEPROM 存储器中的数据可以断电保存，而 SRAM 内的数据则是掉电丢失的。</p>
</blockquote>
<p><strong>Arduino Uno</strong>板载的<a href="http://ww1.microchip.com/downloads/en/DeviceDoc/Atmel-7810-Automotive-Microcontrollers-ATmega328P_Datasheet.pdf" target="_blank" rel="noopener">ATmega328P</a>微控制器拥有<code>32k Bytes</code>的 <strong>Flash</strong> 存储器（其中<code>0.5k Bytes</code>用于<code>Bootloader</code>），以及<code>2k Bytes</code>的 <strong>SRAM</strong> 和<code>1k Bytes</code>的 <strong>EEPROM</strong>。相比于<strong>Arduino Mega 2560</strong>板载<strong>ATmega2560</strong>微控制器拥有的<code>256k Bytes</code>的 <strong>Flash</strong> 存储器（其中<code>8KB</code>用于<code>Bootloader</code>），以及<code>8k Bytes</code>的 <strong>SRAM</strong> 与<code>4k Bytes</code>的 <strong>EEPROM</strong>。<strong>Arduino Uno</strong> 的存储资源相对要逊色不少，特别是 SRAM 过低将会引发程序执行错误，例如下面的代码：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">char</span> name[] = <span class="string">"I am Hank"</span>;</span><br></pre></td></tr></table></figure>
<p>这段代码执行时，由 9 个字母组成的字符数组将会被放入 SRAM，由于每个字母的 ASCII 码会占用一个<code>Byte</code>，加上最后的<code>\0</code>结束符，那么<code>name[]</code>总共会占用<code>9 + 1 = 10</code>个字节，貌似看起来不多，但是在需要大量显示文本或者进行查表操作的时候，虽然程序能够正常的编译并且上传，但是执行的时候 SRAM 空间将会很快发生溢出，从而导致程序以不可预料的方式执行失败。</p>
<p>综上所述，为了节约宝贵的存储空间，除了尽量采用较小的数据类型以外，还可以将代码中不需要频繁修改的数据通过<a href="https://www.arduino.cc/reference/en/language/variables/utilities/progmem/" target="_blank" rel="noopener"><code>PROGMEM</code></a>关键字存放至 Flash 存储器：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> PROGMEM dataType variableName[] = &#123;&#125;; <span class="comment">// 优先使用这种格式</span></span><br><span class="line"><span class="keyword">const</span> dataType variableName[] PROGMEM = &#123;&#125;; <span class="comment">// 或者使用这种格式</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> dataType PROGMEM variableName[] = &#123;&#125;; <span class="comment">// 但是这种格式不被允许</span></span><br></pre></td></tr></table></figure>
<p>将上面字符数组<code>name[]</code>的定义修改为如下格式，就可以确保数据保存至<code>Flash</code>存储器。</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> PROGMEM <span class="keyword">char</span> name[] = <span class="string">"I am Hank"</span>;</span><br></pre></td></tr></table></figure>
<h2 id="引脚资源">引脚资源</h2>
<p><strong>Arduino Uno R3</strong> 开发板的推荐输出电压为<code>7-12V</code>，极限输出电压为<code>6-20V</code>。每个 IO 引脚的输出电流为<code>20mA</code>，而<code>3.3V</code>引脚的输出电流为<code>50mA</code>。同时具备 <strong>14</strong> 个数字输入/输出引脚（其中 <strong>6</strong> 个可以用作 PWM 输出），以及 <strong>6</strong> 个模拟输入接口，开发板 IO 引脚的详细功能示意图如下所示：</p>
<p><img src="/Embedded/Arduino/Pin/diagram-1.png"></p>
<p>Arduino 开发板的 ISCP（电路内串行编程，In-Circuit Serial Programming）引脚，它们直接与 <strong>ATmega328P</strong> 微控制器连接，分别用于<code>VCC</code>、<code>MISO</code>、<code>MOSI</code>、<code>SCK</code>、<code>GND</code>、<code>RESET</code>功能，其主要用途是通过串行接口向微控制器烧写程序。</p>
<p><img src="/Embedded/Arduino/Pin/diagram-2.png"></p>
<blockquote>
<p>注意：由于 Arduino Uno R3 已经内置<code>CH340</code>串口 USB 转换芯片，所以通常直接通过 USB 接口完成烧录，因而 ICSP 引脚较少被使用。</p>
</blockquote>
<p>上述示意图当中各种颜色和图案所表达的意义如下表所示：</p>
<p><img src="/Embedded/Arduino/Pin/diagram-3.png"></p>
<h3 id="数字引脚-digital">数字引脚 Digital</h3>
<p>Arduino 的引脚可以分别配置为<strong>输入</strong>或者<strong>输出</strong>，采用 Atmega 芯片的数字、模拟引脚都可以采用基本相同的方式进行配置。</p>
<h4 id="input-输入">INPUT 输入</h4>
<p>Atmega 芯片的引脚<strong>默认为输入模式</strong>，此时引脚处于<code>high-impedance state</code>高阻抗状态，类似于输入引脚前面串联了一枚<code>100MΩ</code>电阻。这意味着当引脚入处于默认状态或者被配置为<code>pinMode(pin, INPUT)</code>的时候，极易遭到外部干扰。因此 Arduino 官方建议将没有使用的引脚，通过<code>上拉电阻</code>（连接+5V）或者<code>下拉电阻</code>（连接 GND），设置为一个已知的确定状态，这里的电阻建议选取<code>10KΩ</code>阻值。</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> pin_test = <span class="number">5</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">setup</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  <span class="built_in">Serial</span>.<span class="built_in">begin</span>(<span class="number">9600</span>);                   <span class="comment">// 初始化串口，设置波特率为 9600</span></span><br><span class="line">  <span class="built_in">pinMode</span>(pin_test, <span class="literal">INPUT</span>);             <span class="comment">// 初始化引脚为输入 INPUT</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">loop</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  <span class="keyword">int</span> status = <span class="built_in">digitalRead</span>(pin_test);   <span class="comment">// 读取目标引脚的状态</span></span><br><span class="line">  <span class="built_in">Serial</span>.<span class="built_in">println</span>(status);               <span class="comment">// 串口打印状态值</span></span><br><span class="line">  <span class="built_in">delay</span>(<span class="number">1000</span>);                          <span class="comment">// 循环读取引脚状态的间隔时间为 1 秒</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>上面代码将数字引脚 <strong>D5</strong> 设置为<code>INPUT</code>输入模式，然后将 <strong>D5</strong> 用杜邦线分别短接至 Arduino Uno 的<code>3.3V</code>、<code>5V</code>、<code>GND</code>引脚，然后观察串口打印的 <strong>D5</strong> 引脚电平状态，会发现短接至<code>3.3V</code>、<code>5V</code>接口的时候输入状态皆为高电平<code>1</code>，而短接至<code>GND</code>引脚的时候则输入状态为低电平<code>0</code>。</p>
<p><img src="/Embedded/Arduino/Pin/serial-print.png"></p>
<h4 id="input_pullup-上拉输入">INPUT_PULLUP 上拉输入</h4>
<p>Atmega 芯片引脚上内置有<code>20KΩ</code>上拉电阻，调用<code>pinMode(pin, INPUT_PULLUP)</code>函数即可以设置为使能。一旦使能则该引脚行为就会与普通<code>INPUT</code>模式相反，例如：当外接有传感器时，将传感器连接到配置为<code>INPUT_PULLUP</code>模式的引脚，而另一端接入<code>GND</code>，那么当开关断开时该引脚会读取到高电平（由内部上拉电阻拉高），而当开关按下时引脚则会读取到低电平（由于另一端接入了<code>GND</code>），即高电平<code>HIGH</code>关闭传感器，低电平<code>LOW</code>打开传感器。</p>
<blockquote>
<p><strong>注意</strong>：由于上拉电阻的存在，Arduino 引脚可能无法为点亮 LED 提供足够的电流。</p>
</blockquote>
<p>无论当前引脚状态为<code>HIGH</code>或者<code>LOW</code>，上拉电阻的控制都是由微控制器内部的相同寄存器来完成的。因此，如果某个引脚被配置为<code>INPUT_PULLUP</code>上拉电阻接通，如果该引脚随后通过<code>pinMode()</code>切换至<code>OUTPUT</code>，此时该引脚的状态将被设置为<code>HIGH</code>，而再通过<code>pinMode()</code>切换至<code>INPUT</code>，则处于<code>HIGH</code>状态的<code>OUTPUT</code>引脚同样将会使能上拉电阻。这也正是 <strong>Arduino 1.0.1</strong> 之前版本里，可以通过如下代码使能上拉电阻的原因：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">pinMode</span>(pin, <span class="literal">INPUT</span>);           <span class="comment">// 设置引脚为输入模式</span></span><br><span class="line"><span class="built_in">digitalWrite</span>(pin, <span class="literal">HIGH</span>);       <span class="comment">// 开启上拉电阻</span></span><br></pre></td></tr></table></figure>
<p>下面来编写一段测试代码，将数字引脚 <strong>D13</strong> 设置为上拉输入模式<code>INPUT_PULLUP</code>，此时由于内部上拉电阻的作用，串口打印出的该引脚状态将会总是高电平<code>1</code>：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> pin_test = <span class="number">13</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">setup</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  <span class="built_in">Serial</span>.<span class="built_in">begin</span>(<span class="number">9600</span>);                   <span class="comment">// 初始化串口，设置波特率为 9600</span></span><br><span class="line">  <span class="built_in">pinMode</span>(pin_test, <span class="literal">INPUT_PULLUP</span>);      <span class="comment">// 初始化引脚为上拉输入 INPUT_PULLUP</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">loop</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  <span class="keyword">int</span> status = <span class="built_in">digitalRead</span>(pin_test);   <span class="comment">// 读取目标引脚的状态</span></span><br><span class="line">  <span class="built_in">Serial</span>.<span class="built_in">println</span>(status);               <span class="comment">// 串口打印状态值</span></span><br><span class="line">  <span class="built_in">delay</span>(<span class="number">1000</span>);                          <span class="comment">// 循环读取引脚状态的间隔时间为 1 秒</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<blockquote>
<p><strong>注意</strong>：谨慎考虑将数字引脚 <strong>D13</strong> 用作输入模式，由于该引脚还连接了电阻和 LED 元件，如果使能内置<code>20KΩ</code>上拉电阻，则其电压将会徘徊在<code>1.7V</code>左右，而非预期的<code>5V</code>，这意味着该引脚会始终返回状态<code>LOW</code>。如果必须将该引脚用作数字输入，则需要将其<code>pinMode()</code>设置为<code>INPUT</code>然后再使用一个外置的下拉电阻。</p>
</blockquote>
<h4 id="output-输出">OUTPUT 输出</h4>
<p>Arduino Uno 可以通过<code>pinMode()</code>将 Atmega 芯片的引脚配置为<code>OUTPUT</code>模式，此时引脚处于低阻抗状态（low-impedance state），这意味着引脚可以为外置电路提供较大的电流（最高可达<code>40mA</code>）。下面的测试代码，用于循环间隔 1 秒输出数字引脚 <strong>D2</strong> 的状态：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> pin_test = <span class="number">2</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">setup</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  <span class="built_in">Serial</span>.<span class="built_in">begin</span>(<span class="number">9600</span>);                   <span class="comment">// 初始化串口，设置波特率为 9600</span></span><br><span class="line">  <span class="built_in">pinMode</span>(pin_test, <span class="literal">OUTPUT</span>);            <span class="comment">// 初始化引脚</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">loop</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  <span class="built_in">digitalWrite</span>(pin_test, <span class="literal">HIGH</span>);         <span class="comment">// 输出高电平 HIGH</span></span><br><span class="line">  <span class="built_in">delay</span>(<span class="number">1000</span>);                          <span class="comment">// 延时 1 秒</span></span><br><span class="line">  printSerial();                        <span class="comment">// 调用串口打印函数</span></span><br><span class="line">  <span class="built_in">digitalWrite</span>(pin_test, <span class="literal">LOW</span>);          <span class="comment">// 输出低电平 LOW</span></span><br><span class="line">  <span class="built_in">delay</span>(<span class="number">1000</span>);                          <span class="comment">// 等待 1 秒</span></span><br><span class="line">  printSerial();                        <span class="comment">// 调用串口打印函数</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 串口打印函数，用于输出当前引脚状态 */</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">printSerial</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  <span class="keyword">int</span> status = <span class="built_in">digitalRead</span>(pin_test);   <span class="comment">// 读取目标引脚的状态</span></span><br><span class="line">  <span class="built_in">Serial</span>.<span class="built_in">println</span>(status);               <span class="comment">// 串口打印状态值</span></span><br><span class="line">  <span class="built_in">delay</span>(<span class="number">1000</span>);                          <span class="comment">// 循环读取状态的间隔时间为 1 秒</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<blockquote>
<p><strong>注意</strong>：将 Arduino 的引脚进行短路或者试图通过其负载大电流设备，都有可能会损坏引脚上的晶体管，甚至烧毁整个 Atmega 芯片。因此为了避免不必要的损失，最好将输出引脚连接至具备<code>470Ω</code>或<code>1kΩ</code>电阻的设备上面。</p>
</blockquote>
<h3 id="模拟引脚-analog">模拟引脚 Analog</h3>
<p>Arduino 板载的 ATmega 微控制器包含 1 个 6 通道<strong>模数转换器 ADC</strong>，该转换器具备 10 位分辨率，可以返回<code>0 ~ 1023</code>之间的整数。除此之外，模拟引脚还具备数字 GPIO 引脚的所有功能，其用作数字用途时功能与数字引脚<code>D0 ~ D13</code>一致。代码当中可以通过别名<code>A0 ~ A5</code>引用模拟引脚，当然也可以将模拟引脚作为数字引脚那样使用。例如，下面代码将模拟引脚<code>A0</code>设置为输出模式<code>OUTPUT</code>，并间隔 1 秒切换其电平状态：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> pin_test = A0;                      <span class="comment">// 模拟引脚 A0 ~ A5</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">setup</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  <span class="built_in">Serial</span>.<span class="built_in">begin</span>(<span class="number">9600</span>);                   <span class="comment">// 初始化串口，设置波特率为 9600</span></span><br><span class="line">  <span class="built_in">pinMode</span>(pin_test, <span class="literal">OUTPUT</span>);            <span class="comment">// 初始化引脚</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">loop</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  <span class="built_in">digitalWrite</span>(pin_test, <span class="literal">HIGH</span>);         <span class="comment">// 输出高电平 HIGH</span></span><br><span class="line">  <span class="built_in">delay</span>(<span class="number">1000</span>);                          <span class="comment">// 延时 1 秒</span></span><br><span class="line">  printSerial();                        <span class="comment">// 调用串口打印函数</span></span><br><span class="line">  <span class="built_in">digitalWrite</span>(pin_test, <span class="literal">LOW</span>);          <span class="comment">// 输出低电平 LOW</span></span><br><span class="line">  <span class="built_in">delay</span>(<span class="number">1000</span>);                          <span class="comment">// 等待 1 秒</span></span><br><span class="line">  printSerial();                        <span class="comment">// 调用串口打印函数</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 串口打印函数，用于输出当前引脚状态 */</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">printSerial</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  <span class="keyword">int</span> status = <span class="built_in">digitalRead</span>(pin_test);   <span class="comment">// 读取目标引脚的状态</span></span><br><span class="line">  <span class="built_in">Serial</span>.<span class="built_in">println</span>(status);               <span class="comment">// 串口打印状态值</span></span><br><span class="line">  <span class="built_in">delay</span>(<span class="number">1000</span>);                          <span class="comment">// 循环读取状态的间隔时间为 1 秒</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>模拟引脚也具有上拉电阻特性，其作用与数字引脚的上拉电阻相同，可以通过如下代码进行启用：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">pinMode</span>(A0，<span class="literal">INPUT_PULLUP</span>); <span class="comment">// 将模拟引脚 0 设置为输入上拉</span></span><br></pre></td></tr></table></figure>
<blockquote>
<p><strong>注意</strong>：打开上拉电阻会影响<code>analogRead()</code>函数的返回值。</p>
</blockquote>
<p>如果之前已经将引脚设置为<code>OUTPUT</code>输出模式，那么<code>AnalogRead()</code>函数将会无法正常工作，因此，调用该函数之前需要将其设置回<code>INPUT</code>输入模式。同样的，如果该引脚已经被设置为高电平作为输出状态，那么当切换回输入状态时，则需要使能上拉电阻。</p>
<p>ATmega 数据手册警告不要在相近的时间内，让 A/D 通过<code>analogRead()</code>函数访问其它的模拟引脚，否则可能会引起信号的抖动与噪声。正确的做法是在操作模拟引脚（数字模式下）之后，调用<code>analogRead()</code>读取模拟引脚之前，进行一次短暂的延时操作。</p>
<h3 id="脉冲宽度调制-pwm">脉冲宽度调制 PWM</h3>
<p>Arduino IDE 上附带的 <code>文件 &gt; 示例 &gt; 03.Analog &gt; Fade</code> 示例，展示了如何通过<code>analogWrite()</code>函数，以 PWM 模拟输出的方式控制 LED 的淡入淡出（渐亮与渐暗）。</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> ledPin = <span class="number">9</span>;    <span class="comment">// LED 正极连接至数字 D9 引脚，而负极连接到 GND</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">setup</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  <span class="comment">// 不需要进行任何设置</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">loop</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  <span class="comment">/* 淡入，从最暗到最亮，每次增加 5 点亮度 */</span></span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">int</span> fadeValue = <span class="number">0</span> ; fadeValue &lt;= <span class="number">255</span>; fadeValue += <span class="number">5</span>) &#123;</span><br><span class="line">    <span class="built_in">analogWrite</span>(ledPin, fadeValue);   <span class="comment">// 设置值，范围从 0 ~ 255</span></span><br><span class="line">    <span class="built_in">delay</span>(<span class="number">30</span>);                        <span class="comment">// 延时 30 毫秒以展示效果</span></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">/* 淡出，从最亮到最暗，每次减少 5 点亮度 */</span></span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">int</span> fadeValue = <span class="number">255</span> ; fadeValue &gt;= <span class="number">0</span>; fadeValue -= <span class="number">5</span>) &#123;</span><br><span class="line">    <span class="built_in">analogWrite</span>(ledPin, fadeValue);   <span class="comment">// 设置值，范围从 0 ~ 255</span></span><br><span class="line">    <span class="built_in">delay</span>(<span class="number">30</span>);                        <span class="comment">// 延时 30 毫秒以展示效果</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>PWM 是指脉冲宽度调制（Pulse Width Modulation），是一种通过<strong>数字方式</strong>获得<strong>模拟结果</strong>的技术。通过创建数字方波，控制（调制）信号开关状态（<code>5V</code>或者<code>0V</code>）的持续时间（即脉冲宽度），从而获得近似的模拟值，实现 LED 淡入淡出的效果。</p>
<p><img src="/Embedded/Arduino/Pin/PWM.gif"></p>
<p>上面是<code>Fade</code>示例代码的波形示意图，其中<strong>绿线</strong>代表固定的时间间隔，这个时间是 PWM 频率的倒数。换而言之，当 PWM 频率为<code>500Hz</code>的时候，每格绿线间隔就代表<code>2ms</code>毫秒。调用<code>analogWrite()</code>的时间范围为<code>0 ~ 255</code>，那么<code>analogWrite(255)</code>表示占空比为<code>100%</code>（<code>2ms</code>时间内始终打开），而<code>analogWrite(127)</code>则表示占空比为<code>50％</code>（打开约一半时间）。</p>
<p><img src="/Embedded/Arduino/Pin/DSO.gif"></p>
<p>上图为笔者采用数字示波器对<code>Fade</code>示例中的 <strong>D9</strong> 和 <strong>GND</strong> 引脚采样所获得的动态波形图，从动图当中可以看到电平信号的宽度始终处于线性的变化之中。</p>
<h2 id="arduino-c">Arduino C++</h2>
<p>Arduino IDE 采用 <strong>C++</strong> 作为开发语言，但是裁剪了面向对象以及一些较为复杂的语法特性，然后增加了一些特性关键字，所有源代码都通过称为<code>Sketch [sketʃ] 草图</code>的工程项目进行管理，每份 <strong>Sketch</strong> 包含的代码主要由如下 2 部分组成：</p>
<ul>
<li><code>setup()</code>：主要用于初始化变量与第三方库以及引脚的工作模式，仅会在 Sketch 程序启动的时候执行一次；</li>
<li><code>loop()</code>：放置在<code>setup()</code>函数之后，主要用于放置实际控制 Arduino 开发板的代码。</li>
</ul>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">setup</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  <span class="comment">// 用于放置设置代码，仅运行一次。</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">loop</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  <span class="comment">// 放置功能代码，无限循环执行。</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="常量">常量</h3>
<h4 id="整型常量">整型常量</h4>
<p>整型常量就是<code>Sketch</code>代码中直接声明的各种整型数据，默认情况下为 10 进制，但是通过特殊的标识符与格式，可以分别转换为二、八、十六进制。</p>
<table>
<thead>
<tr class="header">
<th>基数</th>
<th>示例</th>
<th>格式</th>
<th>可用字符</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>10</code>进制（<strong>D</strong>ecimal）</td>
<td><code>123</code></td>
<td>-</td>
<td></td>
</tr>
<tr class="even">
<td><code>2</code>进制（<strong>B</strong>inary）</td>
<td><code>B1111011</code></td>
<td>字母<code>B</code>前缀</td>
<td><code>0</code>和<code>1</code></td>
</tr>
<tr class="odd">
<td><code>8</code>进制（<strong>O</strong>ctal）</td>
<td><code>0173</code></td>
<td>数字<code>0</code>前缀</td>
<td><code>0 - 7</code></td>
</tr>
<tr class="even">
<td><code>16</code>进制（<strong>H</strong>exadecimal）</td>
<td><code>0x7B</code></td>
<td>字母数字<code>0x</code>前缀</td>
<td><code>0 ~ 9</code>、<code>A ~ F</code>、<code>a ~ f</code></td>
</tr>
</tbody>
</table>
<p><strong>注意</strong>：<strong>ATmega328P</strong> 属于 8 位 AVR 单片机，所以最多只能表达 8 位二进制数据，即<code>0 ~ 255</code>范围的整型二进制形式。</p>
<table>
<thead>
<tr class="header">
<th>格式</th>
<th>描述</th>
<th></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>后缀<code>u</code>或<code>U</code></td>
<td>将常量强制转换为<code>unsigned</code>数据格式</td>
<td><code>33u</code></td>
</tr>
<tr class="even">
<td>后缀<code>l</code>或<code>L</code></td>
<td>将常量强制转换为<code>long</code>数据格式</td>
<td><code>100000L</code></td>
</tr>
<tr class="odd">
<td>后缀<code>ul</code>或<code>UL</code></td>
<td>将常量强制转换为<code>unsigned long</code>数据格式</td>
<td><code>32767ul</code></td>
</tr>
</tbody>
</table>
<h4 id="浮点常量">浮点常量</h4>
<p>浮点常量除了使用小数点<code>.</code>表示以外，还可以采用科学计数法<code>E</code>或<code>e</code>进行表达。</p>
<table>
<thead>
<tr class="header">
<th>整型常量</th>
<th>渲染结果</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>10.0</code></td>
<td><span class="math inline">\(10\)</span></td>
</tr>
<tr class="even">
<td><code>2.34E5</code></td>
<td><span class="math inline">\(2.34 \times 10^5 = 234000\)</span></td>
</tr>
<tr class="odd">
<td><code>67e-12</code></td>
<td><span class="math inline">\(67.0 \times 10^{-12} = 0.000000000067\)</span></td>
</tr>
</tbody>
</table>
<h4 id="布尔常量-true-与-false">布尔常量 true 与 false</h4>
<p>Arduino 分别采用<code>true</code>和<code>false</code>来表达<strong>真</strong>和<strong>假</strong>。</p>
<ul>
<li><code>false</code>：通常被定义为<code>0</code>。</li>
<li><code>true</code>：通常被定义为<code>1</code>，但是任意非零的整数（包括负数）也被认为等效于<code>true</code>。</li>
</ul>
<h4 id="电平状态-high-low">电平状态 HIGH LOW</h4>
<p>常量<code>HIGH</code>和<code>LOW</code>分别用于设置数字引脚的电平状态，其作用与当前引脚的输入<code>INPUT</code>输出<code>OUTPUT</code>状态密切相关：</p>
<ul>
<li><code>HIGH</code>：当引脚处于<code>INPUT</code>模式，调用<code>digitalRead()</code>读取到<code>HIGH</code>意味着当前电平状态高于<code>3.0V</code>，即处于高电平状态。如果调用<code>digitalWrite()</code>将设置为<code>INPUT</code>模式的引脚置为高电平<code>HIGH</code>，这将会使能内部的<code>20KΩ</code>上拉电阻，从而持续向引脚输入高电平状态。当然，使能引脚内部上拉电阻的正确做法是将引用的工作模式设置为<code>INPUT_PULLUP</code>。当引脚处于<code>OUTPUT</code>模式时，调用<code>digitalWrite()</code>将引脚状态置为<code>HIGH</code>，此时引脚向外输出的电压为<code>5V</code>。</li>
<li><code>LOW</code>：当引脚处于<code>INPUT</code>模式，如果此时引脚通过<code>digitalRead()</code>读取的电压低于<code>1.5V</code>就会认为处于低电平<code>LOW</code>。当引脚处于<code>OUTPUT</code>模式，调用<code>digitalWrite()</code>将其状态置为<code>LOW</code>，此时引脚输出电压为<code>0V</code>，同时输出的电流也会变得极小。</li>
</ul>
<h4 id="输入状态-input-output-input_pullup">输入状态 INPUT OUTPUT INPUT_PULLUP</h4>
<p>如前所述，常量<code>INPUT</code>、<code>OUTPUT</code>、<code>INPUT_PULLUP</code>用于<code>pinMode()</code>函数设置引脚的工作模式。</p>
<h4 id="板载-led_builtin">板载 LED_BUILTIN</h4>
<p>大部份 Arduino 开发板都会存在一个引脚通过一个电阻连接到一枚板载 LED，常量<code>LED_BUILTIN</code>就表示这枚 LED 所连接的引脚编号，大部分 LED 都会连接到第 <strong>13</strong> 号数字引脚，所以通过串口打印该常量将会输出<code>13</code>。</p>
<h3 id="数据类型">数据类型</h3>
<table>
<colgroup>
<col style="width: 10%">
<col style="width: 13%">
<col style="width: 75%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: center;">数据类型</th>
<th style="text-align: center;">占用存储空间</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;"><code>bool</code></td>
<td style="text-align: center;"><strong>1 Byte</strong>（8bit）</td>
<td><strong>布尔型</strong>，拥有<code>true</code>或<code>false</code>两个值。</td>
</tr>
<tr class="even">
<td style="text-align: center;"><code>boolean</code></td>
<td style="text-align: center;"><strong>1 Byte</strong>（8bit）</td>
<td><strong>布尔型别名</strong>，官方建议代码中使用<code>bool</code>关键字作为数据类型。</td>
</tr>
<tr class="odd">
<td style="text-align: center;"><code>byte</code></td>
<td style="text-align: center;"><strong>1 Byte</strong>（8bit）</td>
<td><strong>字节型</strong>，用于存储<code>0 ~ 255</code>的 8 位<strong>无符号整数</strong>。</td>
</tr>
<tr class="even">
<td style="text-align: center;"><code>word</code></td>
<td style="text-align: center;"><strong>2 Byte</strong>（16bit）</td>
<td><strong>单词型</strong>，用于存储 <code>0 ~ 65535</code> 的<strong>无符号整数</strong>。</td>
</tr>
<tr class="odd">
<td style="text-align: center;"><code>char</code></td>
<td style="text-align: center;"><strong>1 Byte</strong>（8bit）</td>
<td><strong>字符型</strong>，用于存储单引号<code>'h'</code>字符，实际保存是其 <strong>ASCII</strong> 编码。</td>
</tr>
<tr class="even">
<td style="text-align: center;"><code>unsigned char</code></td>
<td style="text-align: center;"><strong>1 Byte</strong>（8bit）</td>
<td><strong>无符号字符型</strong>，其编码为<code>0 ~ 255</code>的数字。</td>
</tr>
<tr class="odd">
<td style="text-align: center;"><code>char string[]</code></td>
<td style="text-align: center;"><code>sizeof()</code></td>
<td><strong>字符串</strong>，本质是字符数组，可以使用双引号进行表示<code>char myString[] = "Hank"</code>。</td>
</tr>
<tr class="even">
<td style="text-align: center;"><code>float</code></td>
<td style="text-align: center;"><strong>4 Byte</strong>（32bit）</td>
<td><strong>浮点型</strong>，用于保存小数，注意数据类型转换时会损失精度。</td>
</tr>
<tr class="odd">
<td style="text-align: center;"><code>double</code></td>
<td style="text-align: center;"><strong>4 Byte</strong>（32bit）</td>
<td><strong>双精度浮点型</strong>，在 Arduino Due 上面占用 <strong>8 Byte</strong>（64bit）。</td>
</tr>
<tr class="even">
<td style="text-align: center;"><code>int</code></td>
<td style="text-align: center;"><strong>2 Byte</strong>（16bit）</td>
<td><strong>整型</strong>，在 Arduino Due 上面占用 <strong>4 Byte</strong>（32bit）。</td>
</tr>
<tr class="odd">
<td style="text-align: center;"><code>unsigned int</code></td>
<td style="text-align: center;"><strong>2 Byte</strong>（16bit）</td>
<td><strong>无符号整型</strong>，只存储正整数，与普通整型区别在于符号位的处理，在 Arduino Due 上占用 <strong>4 Byte</strong>（32bit）。</td>
</tr>
<tr class="even">
<td style="text-align: center;"><code>short</code></td>
<td style="text-align: center;"><strong>2 Byte</strong>（16bit）</td>
<td><strong>短整型</strong>。</td>
</tr>
<tr class="odd">
<td style="text-align: center;"><code>long</code></td>
<td style="text-align: center;"><strong>4 Byte</strong>（32bit）</td>
<td><strong>长整型</strong>。</td>
</tr>
<tr class="even">
<td style="text-align: center;"><code>unsigned long</code></td>
<td style="text-align: center;"><strong>4 Byte</strong>（32bit）</td>
<td><strong>无符号长整型</strong>，用于存储范围更大的正整数。</td>
</tr>
<tr class="odd">
<td style="text-align: center;"><code>size_t</code></td>
<td style="text-align: center;">-</td>
<td>一种以字节 Byte 来表示任意对象大小的数据类型，也是<code>sizeof()</code>和<code>Serial.print()</code>的返回值类型。</td>
</tr>
<tr class="even">
<td style="text-align: center;"><code>void</code></td>
<td style="text-align: center;">-</td>
<td>仅仅用于函数声明，表示当前函数没有任何返回信息。</td>
</tr>
</tbody>
</table>
<p>必要的时候，数据类型之间也可以进行强制转换：</p>
<table>
<thead>
<tr class="header">
<th>Arduino 风格</th>
<th>标准 C 风格</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>(unsigned int)x</code></td>
<td>-</td>
<td>强制转换为<strong>无符号普通整型</strong>。</td>
</tr>
<tr class="even">
<td><code>(unsigned long)x</code></td>
<td>-</td>
<td>强制转换为<strong>无符号长整型</strong>。</td>
</tr>
<tr class="odd">
<td><code>byte(x)</code></td>
<td><code>(byte)x</code></td>
<td>强制转换为<strong>字节型</strong>。</td>
</tr>
<tr class="even">
<td><code>char(x)</code></td>
<td><code>(char)x</code></td>
<td>强制转换为<strong>字符型</strong>。</td>
</tr>
<tr class="odd">
<td><code>float(x)</code></td>
<td><code>(float)x</code></td>
<td>强制转换为<strong>浮点型</strong>。</td>
</tr>
<tr class="even">
<td><code>int(x)</code></td>
<td><code>(int)x</code></td>
<td>强制转换为<strong>普通整型</strong>。</td>
</tr>
<tr class="odd">
<td><code>long(x)</code></td>
<td><code>(long)x</code></td>
<td>强制转换为<strong>长整型</strong>。</td>
</tr>
<tr class="even">
<td><code>word(x, h/l)</code></td>
<td><code>(word)x</code></td>
<td>当第 2 个参数为<code>h</code>表示取<code>word</code>的最<strong>左</strong>侧<strong>高</strong>位字节，为<code>l</code>则是取最<strong>右</strong>侧的<strong>低</strong>位字节。</td>
</tr>
</tbody>
</table>
<p>此外，还可以通过原生的<code>String()</code>函数将不同数据类型构造为一个<code>String</code>类实例，该函数可以采用如下 3 个参数：</p>
<ul>
<li><code>val</code>: 需要转换为<code>String</code>类的变量，允许的数据类型有：<code>string</code>、<code>char</code>、<code>byte</code>、<code>int</code>、<code>long</code>、<code>unsigned int</code>、<code>unsigned long</code>、<code>float</code>、<code>double</code>。</li>
<li><code>base</code>: 输出的进制格式，仅用于处理整型数据。</li>
<li><code>decimalPlaces</code>: 所需的小数位数，仅用于处理浮点类型。</li>
</ul>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* 数值处理 */</span></span><br><span class="line"><span class="keyword">String</span> test = <span class="string">"Hello String"</span>;</span><br><span class="line"><span class="keyword">String</span> test = <span class="keyword">String</span>(<span class="string">'a'</span>);</span><br><span class="line"><span class="keyword">String</span> test = <span class="keyword">String</span>(<span class="string">"This is a string"</span>);</span><br><span class="line"><span class="keyword">String</span> test = <span class="keyword">String</span>(words + <span class="string">" with more"</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 字符与字符串处理 */</span></span><br><span class="line"><span class="keyword">String</span> test = <span class="keyword">String</span>(<span class="number">13</span>);</span><br><span class="line"><span class="keyword">String</span> test = <span class="keyword">String</span>(<span class="built_in">analogRead</span>(<span class="number">0</span>), DEC);</span><br><span class="line"><span class="keyword">String</span> test = <span class="keyword">String</span>(<span class="number">45</span>, HEX);</span><br><span class="line"><span class="keyword">String</span> test = <span class="keyword">String</span>(<span class="number">255</span>, BIN);</span><br><span class="line"><span class="keyword">String</span> test = <span class="keyword">String</span>(<span class="built_in">millis</span>(), DEC);</span><br><span class="line"><span class="keyword">String</span> test = <span class="keyword">String</span>(<span class="number">5.698</span>, <span class="number">3</span>);</span><br></pre></td></tr></table></figure>
<blockquote>
<p><strong>注意</strong>：整型数据用<code>String()</code>转换为字符串，其结果为该整型数据的 <strong>ASCII</strong> 形式。</p>
</blockquote>
<h3 id="变量限定符">变量限定符</h3>
<p>Arduino C++ 依然允许声明<strong>全局变量</strong>（代码文件全局可见）或者<strong>局部变量</strong>（仅在声明它们的函数中可见）。</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> global = <span class="number">2020</span>;                 <span class="comment">// 全局变量，对于所有函数可见</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">setup</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  <span class="built_in">Serial</span>.<span class="built_in">begin</span>(<span class="number">9600</span>);              <span class="comment">// 初始化串口，设置波特率为 9600</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">loop</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  <span class="keyword">int</span> local = <span class="number">2019</span>;                <span class="comment">// 局部变量，仅在函数内部可见</span></span><br><span class="line">  <span class="built_in">Serial</span>.<span class="built_in">println</span>(global);          <span class="comment">// 串口输出全局变量</span></span><br><span class="line">  <span class="built_in">Serial</span>.<span class="built_in">println</span>(local);           <span class="comment">// 串口输出局部变量</span></span><br><span class="line">  <span class="built_in">delay</span>(<span class="number">1000</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="const">const</h4>
<p>关键字<code>const</code>用于声明一个<strong>只读</strong>的常量，修改其值将会引发编译器错误。</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="keyword">float</span> pi = <span class="number">3.14</span>;</span><br><span class="line"></span><br><span class="line">pi = <span class="number">7</span>;     <span class="comment">// 非法，不能修改一个常量</span></span><br></pre></td></tr></table></figure>
<h4 id="static">static</h4>
<p>关键字<code>static</code>用于声明一个<strong>静态局部变量</strong>，其值在函数调用结束后并不会释放存储单元；下一次函数调用时，该静态局部变量依然继续保留原来的值。</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">setup</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  <span class="built_in">Serial</span>.<span class="built_in">begin</span>(<span class="number">9600</span>);</span><br><span class="line">  test();   <span class="comment">// 静态局部变量index的值为 1</span></span><br><span class="line">  test();   <span class="comment">// 静态局部变量index的值为 2</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">loop</span><span class="params">()</span> </span>&#123;&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">test</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  <span class="keyword">static</span> <span class="keyword">int</span> index = <span class="number">0</span>;</span><br><span class="line">  <span class="built_in">Serial</span>.<span class="built_in">println</span>(++index);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><img src="/Embedded/Arduino/Data-Type/static.png"></p>
<h4 id="volatile">volatile</h4>
<p>关键字<code>volatile [ˈvɒlətaɪl] 不稳定物质</code>用于指示 Arduino 编译器从 <strong>RAM</strong> 加载变量，而非从存储寄存器（存储与操作程序变量的临时内存区域）当中。因为在某些情况下，存储在寄存器中的变量值可能不准确。当一个变量可以被其所处代码块之外的代码修改时，就应该将其声明为<code>volatile</code>，Arduino 里出现这种情况的地方，主要是在<strong>中断服务程序</strong>当中。</p>
<p>如果声明为<code>volatile</code>的变量超过一个字节（例如是一个 16 位的整型或者 32 位的长整型数据），那么 Arduino Uno 的 8 位微控制器将无法一次性完成读取。所以程序的主代码（例如<code>loop()</code>函数）读取<code>volatile</code>变量的<strong>第一个</strong> 8 位的时候，此时中断服务函数可能已经对<strong>第二个</strong> 8 位进行了修改，从而产生一个错误的结果。解决这个问题，需要在主代码读取<code>volatile</code>变量时，通过<code>noInterrupts()</code>函数或者<code>ATOMIC_BLOCK</code>宏禁用中断：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* 当中断引脚状态改变的时候切换 LED 的亮灭 */</span></span><br><span class="line"><span class="keyword">int</span> pin = <span class="number">13</span>;</span><br><span class="line"><span class="keyword">volatile</span> <span class="keyword">byte</span> state = <span class="literal">LOW</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">setup</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  <span class="built_in">pinMode</span>(pin, <span class="literal">OUTPUT</span>);      <span class="comment">// 设置第 13 引脚为输出模式</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">/* 添加数字引脚 2 的中断事件，设置 blink 为中断服务函数，引脚状态发生改变时触发 */</span></span><br><span class="line">  <span class="built_in">attachInterrupt</span>(digitalPinToInterrupt(<span class="number">2</span>), <span class="built_in">blink</span>, CHANGE);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">loop</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  <span class="built_in">digitalWrite</span>(pin, state);  <span class="comment">// 向第 13 引脚写入状态</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">blink</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  state = !state;            <span class="comment">// 状态值取反</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* 这个库包含了 ATOMIC_BLOCK 宏 */</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;util/atomic.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">volatile</span> <span class="keyword">int</span> input_from_interrupt;     <span class="comment">// 声明 volatile 变量</span></span><br><span class="line"></span><br><span class="line">ATOMIC_BLOCK(ATOMIC_RESTORESTATE) &#123;</span><br><span class="line">  <span class="keyword">int</span> result = input_from_interrupt;   <span class="comment">// 中断被阻塞的代码，连续的原子操作不会发生中断</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="progmem">PROGMEM</h4>
<p>如前所述，关键字<code>PROGMEM</code>用于将变量保存在 <strong>Flash</strong> 存储器，而非 <strong>SRAM</strong> 存储器当中。</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">setup</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  <span class="built_in">Serial</span>.<span class="built_in">begin</span>(<span class="number">9600</span>);</span><br><span class="line">  <span class="keyword">const</span> PROGMEM <span class="keyword">char</span> name[] = <span class="string">"I am Hank"</span>;   <span class="comment">// 将字符串保存至 Flash 存储器</span></span><br><span class="line">  <span class="built_in">Serial</span>.<span class="built_in">println</span>(name);                      <span class="comment">// 串口输出保存在 Flash 里的字符串</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">loop</span><span class="params">()</span> </span>&#123;&#125;</span><br></pre></td></tr></table></figure>
<p><img src="/Embedded/Arduino/Data-Type/PROGMEM.png"></p>
<h3 id="数组处理">数组处理</h3>
<p>Arduino C++ 的数组语法与标准 C 语言完全相同。</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> test[<span class="number">6</span>];</span><br><span class="line"><span class="keyword">int</span> test[] = &#123;<span class="number">2</span>, <span class="number">4</span>, <span class="number">8</span>, <span class="number">3</span>, <span class="number">6</span>&#125;;</span><br><span class="line"><span class="keyword">int</span> test[<span class="number">6</span>] = &#123;<span class="number">2</span>, <span class="number">4</span>, <span class="number">-8</span>, <span class="number">3</span>, <span class="number">2</span>&#125;;</span><br><span class="line"><span class="keyword">char</span> test[<span class="number">7</span>] = <span class="string">"uinika"</span>;</span><br></pre></td></tr></table></figure>
<blockquote>
<p><strong>注意</strong>：声明数组长度时，需要增加 1 个结束符。</p>
</blockquote>
<p>数组的遍历与标准 C 语言也是一样的，下面代码将会循环向串口输出<code>"uinika"</code>字符串：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">setup</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  <span class="built_in">Serial</span>.<span class="built_in">begin</span>(<span class="number">9600</span>);</span><br><span class="line">  <span class="keyword">char</span> name[<span class="number">7</span>] = <span class="string">"uinika"</span>;         <span class="comment">// 声明字符串或字符数组</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">7</span>; i++) &#123;</span><br><span class="line">    <span class="built_in">Serial</span>.<span class="built_in">println</span>(name[i]);       <span class="comment">// 串口遍历输出字符串上的每个字符</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">loop</span><span class="params">()</span> </span>&#123;&#125;</span><br></pre></td></tr></table></figure>
<p>注意，采用双引号<code>""</code>声明字符数组时，系统会自动在最后为其分配一个空操作符<code>\0</code>作为结束标志。</p>
<p><img src="/Embedded/Arduino/Data-Type/array-traversal.png"></p>
<p>此外，数组的长度可以调用原生提供的<code>sizeof()</code>函数进行返回：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">setup</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  <span class="built_in">Serial</span>.<span class="built_in">begin</span>(<span class="number">9600</span>);</span><br><span class="line">  <span class="keyword">char</span> name[] = <span class="string">"uinika"</span>;          <span class="comment">// 声明字符串或者字符数组</span></span><br><span class="line">  <span class="built_in">Serial</span>.<span class="built_in">println</span>(<span class="keyword">sizeof</span>(name));   <span class="comment">// 串口输出字符数组长度</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">loop</span><span class="params">()</span> </span>&#123;&#125;</span><br></pre></td></tr></table></figure>
<p><img src="/Embedded/Arduino/Data-Type/length.png"></p>
<h2 id="核心工具函数">核心工具函数</h2>
<h3 id="数字-io">数字 I/O</h3>
<table>
<thead>
<tr>
<th>
数字 I/O
</th>
<th>
功能描述
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
<a href="//www.arduino.cc/reference/en/language/functions/digital-io/pinmode/" target="_blank" rel="noopener">pinMode(pin, mode)</a>
</td>
<td>
配置引脚的工作模式。参数<code>pin</code>是引脚数。 <br> ▶ 参数<code>mode</code>：可以选择<code>INPUT</code>（输入）、<code>OUTPUT</code>（输出）、<code>INPUT_PULLUP</code>（输入上拉）； <br> ▶ 返回值：无；
</td>
</tr>
<tr>
<td>
<a href="//www.arduino.cc/reference/en/language/functions/digital-io/digitalread/" target="_blank" rel="noopener">digitalRead(pin)</a>
</td>
<td>
从指定数字引脚读取当前的电平状态，可以是<code>HIGH</code>或者<code>LOW</code>。 <br> ▶ 参数<code>pin</code>：需要读取状态的引脚编号； <br> ▶ 返回值：<code>HIGH</code>或者<code>LOW</code>；
</td>
</tr>
<tr>
<td>
<a href="//www.arduino.cc/reference/en/language/functions/digital-io/digitalwrite/" target="_blank" rel="noopener">digitalWrite(pin, value)</a>
</td>
<td>
将<code>HIGH</code>或<code>LOW</code>状态写入指定的数字引脚。 <br> ▶ 参数<code>pin</code>：需要写入的引脚编号； <br> ▶ 参数<code>value</code>：<code>HIGH</code>或者<code>LOW</code>； <br> ▶ 返回值：无；
</td>
</tr>
</tbody>
</table>
<h3 id="模拟-io">模拟 I/O</h3>
<table>
<thead>
<tr>
<th>
模拟 I/O
</th>
<th>
功能描述
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
<a href="//www.arduino.cc/reference/en/language/functions/analog-io/analogread/" target="_blank" rel="noopener">analogRead(pin)</a>
</td>
<td>
从指定的模拟引脚读取数值，Arduino Uno 包含一个多通道的 10 位模数转换器，能够将<code>0V ~ 5V</code>映射为<code>0 ~ 1023</code>的整数值，其中每个单元所表示的电压为 <span class="math inline">\(\frac{5V}{1024} \approx 0.0049V = 4.9 mV\)</span>；读取一次模拟输入需要消耗<code>100</code>微秒（即<code>0.0001</code>秒），因此读取模拟输入的最大频率为<code>10000</code>次/秒。 <br> ▶ 参数<code>pin</code>：需要进行读取操作的模拟引脚编号； <br> ▶ 返回值：<code>0 ~ 1023</code>之间的整数值； <br> ✸ 当模拟输入引脚没有任何连接时，调用<code>analogRead()</code>获得的返回值是一个随机数值，该数值受到多种因素影响，例如将手指靠近该引脚也会引发变化。
</td>
</tr>
<tr>
<td>
<a href="//www.arduino.cc/reference/en/language/functions/analog-io/analogwrite/" target="_blank" rel="noopener">analogWrite(pin, value)</a>
</td>
<td>
向指定引脚写入模拟数值，以产生固定频率的 PWM 波形。Arduino Uno 提供<code>3</code>、<code>5</code>、<code>6</code>、<code>9</code>、<code>10</code>、<code>11</code>为 PWM 引脚，可输出频率为<code>490 Hz</code>（其中 5 和 6 引脚为 <code>980Hz</code>）的 PWM 波形。 <br> ▶ 参数<code>pin</code>：需要进行读取操作的模拟引脚编号； <br> ▶ 参数<code>value</code>：为<code>0</code>（关断）到<code>255</code>（打开）之间的 整型占空比； <br> ▶ 返回值：无；
</td>
</tr>
<tr>
<td>
<a href="//www.arduino.cc/reference/en/language/functions/analog-io/analogreference/" target="_blank" rel="noopener">analogReference(type)</a>
</td>
<td>
配置模拟输入参考电压的范围与解析度，对于 Arduino Uno 可以选择如下参数： <br> ▶ 参数<code>type</code>：<code>DEFAULT</code>（默认模拟参考电压为<code>5V</code>），<code>INTERNAL</code>（<strong>ATmega328P</strong> 内建参考电压<code>1.1V</code>）； <br> ▶ 返回值：无；
</td>
</tr>
</tbody>
</table>
<h3 id="高级-io">高级 I/O</h3>
<table>
<thead>
<tr>
<th>
高级 I/O
</th>
<th>
功能描述
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
<a href="//www.arduino.cc/reference/en/language/functions/advanced-io/tone/" target="_blank" rel="noopener">tone(pin, frequency, duration)</a>
</td>
<td>
用于生成指定频率（以及<code>50%</code>占空比）的方波信号，可以驱动压电式蜂鸣器或者扬声器播放指定频率音调。注意，Arduino Uno 只能同时通过<code>tone()</code>从一个引脚产生信号，此时其它引脚无法通过调用<code>tone()</code>输出信号。 <br> ▶ 参数<code>pin</code>：需要输出信号的引脚编号； <br> ▶ 参数<code>frequency</code>：输出信号的频率，数据类型为<code>unsigned int</code>； <br> ▶ 参数<code>duration</code>：信号持续时间，以毫秒作为单位，数据类型为<code>unsigned long</code>； <br> ▶ 返回值：无；
</td>
</tr>
<tr>
<td>
<a href="//www.arduino.cc/reference/en/language/functions/advanced-io/notone/" target="_blank" rel="noopener">noTone(pin)</a>
</td>
<td>
停止生成由<code>tone()</code>函数触发的方波信号，如果需要使用多个引脚输出信号，必须在每个引脚输出信号前调用<code>noTone()</code>函数停止其它引脚输出信号。 <br> ▶ 参数<code>pin</code>：需要停止信号输出的引脚编号； <br> ▶ 返回值：无；
</td>
</tr>
<tr>
<td>
<a href="//www.arduino.cc/reference/en/language/functions/advanced-io/pulsein/" target="_blank" rel="noopener">pulseIn(pin, value, timeout)</a>
</td>
<td>
获取指定引脚的脉冲状态持续时间, 例如当前想检测脉冲信号<code>HIGH</code>，那么 Arduino 会在引脚变为<code>HIGH</code>时开始计时，引脚变为<code>LOW</code>之后停止记时，最后返回以毫秒为单位的脉冲持续时间，如果在超时时间内没有读取到脉冲信号，那么就会返回<code>0</code>。 <br> ▶ 参数<code>pin</code>：需要获取脉冲状态的引脚编号； <br> ▶ 参数<code>value</code>：需要读取的脉冲类型，值为<code>HIGH</code>或者<code>LOW</code>两者之一，数据类型为<code>unsigned int</code>； <br> ▶ 参数<code>timeout</code>：可选，超时时间，以毫秒为单位，默认为<code>1</code>秒，数据类型为<code>unsigned long</code>； <br> ▶ 返回值：脉冲持续的时间长度，如果在超时时间内没有读到脉冲信号则返回<code>0</code>，数据类型为<code>unsigned long</code>；
</td>
</tr>
<tr>
<td>
<a href="//www.arduino.cc/reference/en/language/functions/advanced-io/pulseinlong" target="_blank" rel="noopener">pulseInLong(pin, value, timeout)</a>
</td>
<td>
<code>pulseIn()</code>的替代方法，更适合处理长脉冲和受中断影响的场景，其功能和参数与<code>pulseIn()</code>基本一致。但是由于该函数依赖于<code>micros()</code>，因此不能被用于<code>noInterrupts()</code>函数的上下文。 <br> ▶ 参数<code>pin</code>：需要获取脉冲状态的引脚编号； <br> ▶ 参数<code>value</code>：需要读取的脉冲类型，值为<code>HIGH</code>或者<code>LOW</code>两者之一，数据类型为<code>unsigned int</code>； <br> ▶ 参数<code>timeout</code>：可选，超时时间，以毫秒为单位，默认为<code>1</code>秒，数据类型为<code>unsigned long</code>； <br> ▶ 返回值：脉冲持续的时间长度，如果在超时时间内没有读到脉冲信号则返回<code>0</code>，数据类型为<code>unsigned long</code>；
</td>
</tr>
<tr>
<td>
<a href="//www.arduino.cc/reference/en/language/functions/advanced-io/shiftin/" target="_blank" rel="noopener">shiftIn(dataPin, clockPin, bitOrder)</a>
</td>
<td>
将 1 个字节的数据通过移位方式逐位进行<strong>输入</strong>，数据可以从最高位（最左侧）或者最低位（最右侧）输入。Arduino 会首先在时钟引脚输出<code>HIGH</code>，然后通过数据引脚读取 1 位数据，读取完成之后时钟引脚会被设置为<code>LOW</code>。 <br> ▶ 参数<code>dataPin</code>：输入位数据的引脚编号，允许的数据类型为<code>int</code>； <br> ▶ 参数<code>clockPin</code>：时钟信号引脚编号，允许的数据类型为<code>int</code>； <br> ▶ 参数<code>bitOrder</code>：位传送的顺序，<code>MSBFIRST</code>（最高有效位优先）或者<code>LSBFIRST</code>（最低有效位优先）二选一； <br> ▶ 返回值：读取到的数据，允许的数据类型为<code>byte</code>； <br> ✸ 如果与 Arduino 通信的设备是在时钟引脚脉冲信号的上升沿发送数据，那么需要确保在调用<code>shiftIn()</code>之前，首先调用<code>digitalWrite(clockPin, LOW)</code>将时钟引脚设置为<code>LOW</code>，从而确保数据读取准确无误。
</td>
</tr>
<tr>
<td>
<a href="//www.arduino.cc/reference/en/language/functions/advanced-io/shiftout/" target="_blank" rel="noopener">shiftOut(dataPin, clockPin, bitOrder, value)</a>
</td>
<td>
将 1 个字节的数据通过移位方式逐位进行<strong>输出</strong>，数据可以从最高位（最左侧）或者最低位（最右侧）输出。Arduino 会首先在时钟引脚输出<code>HIGH</code>，然后通过数据引脚读取 1 位数据，读取完成之后时钟引脚会被设置为<code>LOW</code>。 <br> ▶ 参数<code>dataPin</code>：输出位数据的引脚编号，允许的数据类型为<code>int</code>； <br> ▶ 参数<code>clockPin</code>：时钟信号引脚编号，允许的数据类型为<code>int</code>； <br> ▶ 参数<code>bitOrder</code>：位传送的顺序，<code>MSBFIRST</code>（最高有效位优先）或者<code>LSBFIRST</code>（最低有效位优先）二选一； <br> ▶ 参数<code>value</code>：需要传送出的数据，允许的数据类型为<code>byte</code>； <br> ▶ 返回值：无； <br> ✸ 如果目标设备是在时钟引脚脉冲信号的上升沿读取 Arduino 上的数据，那么就需要确保调用<code>shiftOut()</code>之前，首先调用<code>digitalWrite(clockPin, LOW)</code>将时钟引脚设置为<code>LOW</code>，从而确保数据读取准确无误。
</td>
</tr>
</tbody>
</table>
<h3 id="zeroduemkr-专属-io">Zero、Due、MKR 专属 I/O</h3>
<table>
<thead>
<tr>
<th>
Zero、Due、MKR 专属 I/O
</th>
<th>
功能描述
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
<a href="//www.arduino.cc/reference/en/language/functions/zero-due-mkr-family/analogreadresolution/" target="_blank" rel="noopener">analogReadResolution(bits)</a>
</td>
<td>
以位<code>bit</code>为单位设置<code>analogRead()</code>返回值大小，由于 Zero、Due、MKR 系列开发板拥有 12 位 ADC 功能，其分辨率最高可以调整至<code>12</code>，可以让<code>analogRead()</code>函数的返回值介于<code>0 ~ 4095</code>之间。所以为了向后兼容 AVR 开发板，其默认值限定为<code>10</code>个<code>bit</code>，返回值介于<code>0 ~ 1023</code>之间。 <br> ▶ 参数<code>bits</code>：决定<code>analogRead()</code>函数返回值的位分辨率，取值范围介于<code>1 ~ 32</code>之间，如果取值超出开发板提供的范围，则按照该开发板能够处理的最高分辨率处理。 <br> ▶ 返回值：无；
</td>
</tr>
<tr>
<td>
<a href="//www.arduino.cc/reference/en/language/functions/zero-due-mkr-family/analogwriteresolution/" target="_blank" rel="noopener">analogWriteResolution(bits)</a>
</td>
<td>
以位<code>bit</code>为单位设置<code>analogWrite()</code>函数的输出分辨率，同样为了向后兼容 AVR 开发板，其默认值被限定为<code>8</code>个<code>bit</code>，返回值介于<code>0 ~ 255</code>之间。 <br> ▶ 参数<code>bits</code>：决定<code>analogWrite()</code>函数所使用的位分辨率，取值范围介于<code>1 ~ 32</code>之间，如果取值超出了开发板提供的范围，则按照该开发板能够处理的最高分辨率处理。 <br> ▶ 返回值：无；
</td>
</tr>
</tbody>
</table>
<h3 id="定时">定时</h3>
<table>
<thead>
<tr>
<th>
定时
</th>
<th>
功能描述
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
<a href="//www.arduino.cc/reference/en/language/functions/time/delay/" target="_blank" rel="noopener">delay(ms)</a>
</td>
<td>
让程序的运行停顿参数指定的时间（以<strong>毫秒</strong>为单位），<code>1000</code>毫秒 = <code>1</code>秒。 <br> ▶ 参数<code>ms</code>：延时时间，单位为<strong>毫秒</strong>，允许的数据类型为<code>unsigned long</code>； <br> ▶ 返回值：无；
</td>
</tr>
<tr>
<td>
<a href="//www.arduino.cc/reference/en/language/functions/time/delaymicroseconds/" target="_blank" rel="noopener">delayMicroseconds(us)</a>
</td>
<td>
让程序的运行停顿参数指定的时间（以<strong>微秒</strong>为单位），<code>1000</code>微秒 = <code>1</code>毫秒。 <br> ▶ 参数<code>ms</code>：延时时间，单位为<strong>微秒</strong>，允许的数据类型为<code>unsigned long</code>； <br> ▶ 返回值：无；
</td>
</tr>
<tr>
<td>
<a href="//www.arduino.cc/reference/en/language/functions/time/micros/" target="_blank" rel="noopener">micros()</a>
</td>
<td>
记录 Arduino 启动后运行当前程序的时间（单位为微秒），最长可以记录接近<strong>70</strong>分钟。如果超出记录时间上限，记录将会从<code>0</code>重新开始。在<code>16MHz</code>的 Arduino Uno 开发板上，该函数的分辨率为<code>4</code>微秒，因此每次返回的时间值总是<code>4</code>的倍数。 <br> ▶ 返回值：Arduino 启动后运行当前程序的时间，以<strong>微秒</strong>作为单位 ，允许的数据类型为<code>unsigned long</code>；
</td>
</tr>
<tr>
<td>
<a href="//www.arduino.cc/reference/en/language/functions/time/millis/" target="_blank" rel="noopener">millis()</a>
</td>
<td>
记录 Arduino 启动后运行当前程序的<strong>毫秒</strong>数，最长可以记录至50天，然后归<code>0</code>。 <br> ▶ 返回值：Arduino 启动后运行当前程序的<strong>毫秒</strong>数 ，允许的数据类型为<code>unsigned long</code>；
</td>
</tr>
</tbody>
</table>
<h3 id="数学">数学</h3>
<table>
<thead>
<tr>
<th>
数学
</th>
<th>
功能描述
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
<a href="//www.arduino.cc/reference/en/language/functions/math/abs/" target="_blank" rel="noopener">abs(number)</a>
</td>
<td>
计算一个数值的绝对值。 <br> ▶ 参数<code>number</code>：待计算绝对值的数值； <br> ▶ 返回值：如果参数<code>number</code>大于或者等于<code>0</code>，那么返回<code>+number</code>；如果参数<code>number</code>小于<code>0</code>则返回<code>-number</code>；
</td>
</tr>
<tr>
<td>
<a href="//www.arduino.cc/reference/en/language/functions/math/constrain/" target="_blank" rel="noopener">constrain(x, a, b)</a>
</td>
<td>
将一个数值限制在一个特定范围以内。 <br> ▶ 参数<code>x</code>：需要约束范围的数值，允许所有数据类型； <br> ▶ 参数<code>a</code>：范围的下限，允许所有数据类型； <br> ▶ 参数<code>b</code>：范围的上限，允许所有数据类型； <br> ▶ 返回值：如果<code>a &lt; x &lt; b</code>返回<code>x</code>；如果<code>x &lt; a</code>返回<code>a</code>；如果<code>x &gt; b</code>返回<code>b</code>；
</td>
</tr>
<tr>
<td>
<a href="//www.arduino.cc/reference/en/language/functions/math/map/" target="_blank" rel="noopener">map(value, fromLow, fromHigh, toLow, toHigh)</a>
</td>
<td>
将一个数值从一个区间等比例的映射至另外一个区间，即将<code>fromLow</code>的值映射至<code>toLow</code>，<code>fromHigh</code>的值映射至<code>toHigh</code>，中间值映射至中间值。 <br> ▶ 参数<code>value</code>：需要进行映射的数值； <br> ▶ 参数<code>fromLow</code>：映射之前，区间的最小边界值； <br> ▶ 参数<code>fromHigh</code>： 映射之前，区间的最大边界值； <br> ▶ 参数<code>toLow</code>： 映射之后，区间的最小边界值； <br> ▶ 参数<code>toHigh</code>：映射之后，区间的最大边界值； <br> ▶ 返回值：被映射后的值；
</td>
</tr>
<tr>
<td>
<a href="//www.arduino.cc/reference/en/language/functions/math/max/" target="_blank" rel="noopener">max(x, y)</a>
</td>
<td>
计算两个数值的最大值。 <br> ▶ 参数<code>x</code>：待比较的第 1 个值； <br> ▶ 参数<code>y</code>：待比较的第 2 个值； <br> ▶ 返回值：两个值当中的最大值；
</td>
</tr>
<tr>
<td>
<a href="//www.arduino.cc/reference/en/language/functions/math/min/" target="_blank" rel="noopener">min(x, y)</a>
</td>
<td>
计算两个数值的最小值。 <br> ▶ 参数<code>x</code>：待比较的第 1 个值； <br> ▶ 参数<code>y</code>：待比较的第 2 个值； <br> ▶ 返回值：两个值当中的最小值；
</td>
</tr>
<tr>
<td>
<a href="//www.arduino.cc/reference/en/language/functions/math/pow/" target="_blank" rel="noopener">pow(base, exponent)</a>
</td>
<td>
计算一个幂函数的值。 <br> ▶ 参数<code>base</code>：底数，允许的数据类型为<code>float</code>； <br> ▶ 参数<code>exponent</code>：指数，允许的数据类型为<code>float</code>； <br> ▶ 返回值：求幂运算的结果，允许的数据类型为<code>double</code>；
</td>
</tr>
<tr>
<td>
<a href="//www.arduino.cc/reference/en/language/functions/math/sq/" target="_blank" rel="noopener">sq(x)</a>
</td>
<td>
计算数值的平方结果，即数字乘以自身的值。 <br> ▶ 参数<code>x</code>：待计算的数值，允许为任意数据类型； <br> ▶ 返回值：数值的乘方结果，允许的数据类型为<code>double</code>；
</td>
</tr>
<tr>
<td>
<a href="//www.arduino.cc/reference/en/language/functions/math/sqrt/" target="_blank" rel="noopener">sqrt(number)</a>
</td>
<td>
计算数字的<code>√￣</code>平方根结果，即开方运算。 <br> ▶ 参数<code>x</code>：待计算的数值，允许为任意数据类型； <br> ▶ 返回值：数值的平方根，允许的数据类型为<code>double</code>；
</td>
</tr>
<tr>
<td>
<a href="//www.arduino.cc/reference/en/language/functions/trigonometry/cos/" target="_blank" rel="noopener">cos(radian)</a>
</td>
<td>
以弧度为单位，计算角度的<strong>余弦值</strong>。 <br> ▶ 参数<code>radian</code>：角度的弧度值，允许的数据类型为<code>float</code>； <br> ▶ 返回值：角度的<strong>余弦值</strong>，允许的数据类型为<code>double</code>；
</td>
</tr>
<tr>
<td>
<a href="//www.arduino.cc/reference/en/language/functions/trigonometry/sin/" target="_blank" rel="noopener">sin(radian)</a>
</td>
<td>
以弧度为单位，计算角度的<strong>正弦值</strong>。 <br> ▶ 参数<code>radian</code>：角度的弧度值，允许的数据类型为<code>float</code>； <br> ▶ 返回值：角度的<strong>正弦值</strong>，允许的数据类型为<code>double</code>；
</td>
</tr>
<tr>
<td>
<a href="//www.arduino.cc/reference/en/language/functions/trigonometry/tan/" target="_blank" rel="noopener">tan(radian)</a>
</td>
<td>
以弧度为单位，计算角度的<strong>正切值</strong>。 <br> ▶ 参数<code>radian</code>：角度的弧度值，允许的数据类型为<code>float</code>； <br> ▶ 返回值：角度的<strong>正切值</strong>，允许的数据类型为<code>double</code>；
</td>
</tr>
<tr>
<td>
<a href="//www.arduino.cc/reference/en/language/functions/random-numbers/random/" target="_blank" rel="noopener">random(min, max)</a>
</td>
<td>
用于生成伪随机数。 <br> ▶ 参数<code>max</code>：随机值的上界； <br> ▶ 参数<code>min</code>：可选，随机值的下界； <br> ▶ 返回值：一个介于<code>min ~ max-1</code>之间的伪随机数，允许的数据类型为<code>long</code>；
</td>
</tr>
<tr>
<td>
<a href="//www.arduino.cc/reference/en/language/functions/random-numbers/randomseed/" target="_blank" rel="noopener">randomSeed(seed)</a>
</td>
<td>
用于初始化一个伪随机数生成器，虽然伪随机数会从一个随机序列的任意一点开始生成，但是这个序列总是相同的。采用<code>analogRead()</code>这样随机的输入结果作为该函数参数，就可以确保该序列总是不同的。 <br> ▶ 参数<code>seed</code>：用于初始化伪随机数序列的种子值，允许的数据类型为<code>unsigned long</code>； <br> ▶ 返回值：无；
</td>
</tr>
</tbody>
</table>
<h3 id="字符">字符</h3>
<table>
<thead>
<tr>
<th>
字符
</th>
<th>
功能描述
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
<a href="//www.arduino.cc/reference/en/language/functions/characters/isalpha/" target="_blank" rel="noopener">isAlpha(thisChar)</a>
</td>
<td>
判断一个字符是否是<strong>字母</strong>，如果是则返回<code>true</code>。 <br> ▶ 参数<code>thisChar</code>：字符变量，允许的数据类型为<code>char</code>； <br> ▶ 返回值：<code>true</code>；
</td>
</tr>
<tr>
<td>
<a href="//www.arduino.cc/reference/en/language/functions/characters/isalphanumeric/" target="_blank" rel="noopener">isAlphaNumeric(thisChar)</a>
</td>
<td>
判断一个字符是否为<strong>字母</strong>或者<strong>数字</strong>，如果是则返回<code>true</code>。 <br> ▶ 参数<code>thisChar</code>：字符变量，允许的数据类型为<code>char</code>； <br> ▶ 返回值：<code>true</code>；
</td>
</tr>
<tr>
<td>
<a href="//www.arduino.cc/reference/en/language/functions/characters/isascii/" target="_blank" rel="noopener">isAscii(thisChar)</a>
</td>
<td>
判断一个字符是否为 <strong>ASCII</strong>，如果是则返回<code>true</code>。 <br> ▶ 参数<code>thisChar</code>：字符变量，允许的数据类型为<code>char</code>； <br> ▶ 返回值：<code>true</code>；
</td>
</tr>
<tr>
<td>
<a href="//www.arduino.cc/reference/en/language/functions/characters/iscontrol/" target="_blank" rel="noopener">isControl(thisChar)</a>
</td>
<td>
判断一个字符是否为<strong>控制字符</strong>，如果是则返回<code>true</code>。 <br> ▶ 参数<code>thisChar</code>：字符变量，允许的数据类型为<code>char</code>； <br> ▶ 返回值：<code>true</code>；
</td>
</tr>
<tr>
<td>
<a href="//www.arduino.cc/reference/en/language/functions/characters/isdigit/" target="_blank" rel="noopener">isDigit(thisChar)</a>
</td>
<td>
判断一个字符是否为<strong>数字</strong>，如果是则返回<code>true</code>。 <br> ▶ 参数<code>thisChar</code>：字符变量，允许的数据类型为<code>char</code>； <br> ▶ 返回值：<code>true</code>；
</td>
</tr>
<tr>
<td>
<a href="//www.arduino.cc/reference/en/language/functions/characters/isgraph/" target="_blank" rel="noopener">isGraph(thisChar)</a>
</td>
<td>
判断一个字符是否<strong>可以打印内容</strong>（包含能够产生输出的任意字符，但是不包含无内容的空格），如果是则返回<code>true</code>。 <br> ▶ 参数<code>thisChar</code>：字符变量，允许的数据类型为<code>char</code>； <br> ▶ 返回值：<code>true</code>；
</td>
</tr>
<tr>
<td>
<a href="//www.arduino.cc/reference/en/language/functions/characters/ishexadecimaldigit/" target="_blank" rel="noopener">isHexadecimalDigit(thisChar)</a>
</td>
<td>
判断一个字符是否是<strong>十六进制字符</strong>（<code>0 ~ 9</code>和<code>a ~ f</code>），如果是则返回<code>true</code>。 <br> ▶ 参数<code>thisChar</code>：字符变量，允许的数据类型为<code>char</code>； <br> ▶ 返回值：<code>true</code>；
</td>
</tr>
<tr>
<td>
<a href="//www.arduino.cc/reference/en/language/functions/characters/islowercase/" target="_blank" rel="noopener">isLowerCase(thisChar)</a>
</td>
<td>
判断一个字符是否为<strong>小写格式</strong>，如果是则返回<code>true</code>。 <br> ▶ 参数<code>thisChar</code>：字符变量，允许的数据类型为<code>char</code>； <br> ▶ 返回值：<code>true</code>；
</td>
</tr>
<tr>
<td>
<a href="//www.arduino.cc/reference/en/language/functions/characters/isprintable/" target="_blank" rel="noopener">isPrintable(thisChar)</a>
</td>
<td>
判断一个字符是否可以<strong>打印</strong>（能够产生输出的任意字符，也包含空格），如果是则返回<code>true</code>。 <br> ▶ 参数<code>thisChar</code>：字符变量，允许的数据类型为<code>char</code>； <br> ▶ 返回值：<code>true</code>；
</td>
</tr>
<tr>
<td>
<a href="//www.arduino.cc/reference/en/language/functions/characters/ispunct/" target="_blank" rel="noopener">isPunct(thisChar)</a>
</td>
<td>
判断一个字符是否是<strong>标点符号</strong>（即逗号、分号、感叹号等），如果是则返回<code>true</code>。 <br> ▶ 参数<code>thisChar</code>：字符变量，允许的数据类型为<code>char</code>； <br> ▶ 返回值：<code>true</code>；
</td>
</tr>
<tr>
<td>
<a href="//www.arduino.cc/reference/en/language/functions/characters/isspace/" target="_blank" rel="noopener">isSpace(thisChar)</a>
</td>
<td>
判断一个字符是否是<strong>空白字符</strong>（包括空格<code></code>、分页符<code>\f</code>、换行符<code>\n</code>、回车<code>\r</code>、水平制表符<code>\t</code>、垂直制表符<code>\v</code>），如果是则返回<code>true</code>。 <br> ▶ 参数<code>thisChar</code>：字符变量，允许的数据类型为<code>char</code>； <br> ▶ 返回值：<code>true</code>；
</td>
</tr>
<tr>
<td>
<a href="//www.arduino.cc/reference/en/language/functions/characters/isuppercase/" target="_blank" rel="noopener">isUpperCase(thisChar)</a>
</td>
<td>
判断一个字符是否为<strong>大写格式</strong>，如果是则返回<code>true</code>。 <br> ▶ 参数<code>thisChar</code>：字符变量，允许的数据类型为<code>char</code>； <br> ▶ 返回值：<code>true</code>；
</td>
</tr>
<tr>
<td>
<a href="//www.arduino.cc/reference/en/language/functions/characters/iswhitespace/" target="_blank" rel="noopener">isWhitespace(thisChar)</a>
</td>
<td>
判断一个字符是否是<strong>空格</strong>或者<strong>水平制表符<code>\t</code></strong>，如果是则返回<code>true</code>。 <br> ▶ 参数<code>thisChar</code>：字符变量，允许的数据类型为<code>char</code>； <br> ▶ 返回值：<code>true</code>；
</td>
</tr>
</tbody>
</table>
<h3 id="位操作">位操作</h3>
<table>
<thead>
<tr>
<th>
位操作
</th>
<th>
功能描述
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
<a href="//www.arduino.cc/reference/en/language/functions/bits-and-bytes/bit/" target="_blank" rel="noopener">bit(n)</a>
</td>
<td>
<strong>计算</strong>指定位的值（第 0 位是 1，第 1 位是 2，第 2 位是 4 等等）。 <br> ▶ 参数<code>n</code>：需要计算的位； <br> ▶ 返回值：位的值；
</td>
</tr>
<tr>
<td>
<a href="//www.arduino.cc/reference/en/language/functions/bits-and-bytes/bitclear/" target="_blank" rel="noopener">bitClear(x, n)</a>
</td>
<td>
<strong>清除</strong>一个数值变量的指定位。 <br> ▶ 参数<code>x</code>：待进行位清除操作的数字变量； <br> ▶ 参数<code>n</code>：待清除的位； <br> ▶ 返回值：无；
</td>
</tr>
<tr>
<td>
<a href="//www.arduino.cc/reference/en/language/functions/bits-and-bytes/bitread/" target="_blank" rel="noopener">bitRead(x, n)</a>
</td>
<td>
<strong>读取</strong>指定数值变量的 1 位。 <br> ▶ 参数<code>x</code>：待进行位读取操作的数值； <br> ▶ 参数<code>n</code>：需要读取哪一位，对于最右侧的最低有效位，从第<code>0</code>位开始； <br> ▶ 返回值：无；
</td>
</tr>
<tr>
<td>
<a href="//www.arduino.cc/reference/en/language/functions/bits-and-bytes/bitset/" target="_blank" rel="noopener">bitSet(x, n)</a>
</td>
<td>
将某个数值变量的指定位设置为<code>1</code>。 <br> ▶ 参数<code>x</code>：待进行位设置的数值； <br> ▶ 参数<code>n</code>：需要设置的位，对于最右侧的最低有效位，从第<code>0</code>位开始； <br> ▶ 返回值：无；
</td>
</tr>
<tr>
<td>
<a href="//www.arduino.cc/reference/en/language/functions/bits-and-bytes/bitwrite/" target="_blank" rel="noopener">bitWrite(x, n, b)</a>
</td>
<td>
对数值变量的指定位进行<strong>写入</strong>操作。 <br> ▶ 参数<code>x</code>：待进行位写入操作的数值； <br> ▶ 参数<code>n</code>：需要写入的位，对于最右侧的最低有效位，从第<code>0</code>位开始； <br> ▶ 参数<code>b</code>：需要写入的二进制值（<code>0</code>或者<code>1</code>）； <br> ▶ 返回值：无；
</td>
</tr>
<tr>
<td>
<a href="//www.arduino.cc/reference/en/language/functions/bits-and-bytes/highbyte/" target="_blank" rel="noopener">highByte(x)</a>
</td>
<td>
提取 1 个<code>word</code>字的<strong>最左侧高位字节</strong>（或者对于较大的数据类型是第 2 个最低字节）。 <br> ▶ 参数<code>x</code>：一个任意类型的值； <br> ▶ 返回值：提取的字节，允许的数据类型为<code>byte</code>；
</td>
</tr>
<tr>
<td>
<a href="//www.arduino.cc/reference/en/language/functions/bits-and-bytes/lowbyte/" target="_blank" rel="noopener">lowByte(x)</a>
</td>
<td>
提取 1 个<code>word</code>字的<strong>最右侧低位字节</strong>。 <br> ▶ 参数<code>x</code>：一个任意类型的值； <br> ▶ 返回值：提取的字节，允许的数据类型为<code>byte</code>；
</td>
</tr>
</tbody>
</table>
<h3 id="中断">中断</h3>
<table>
<thead>
<tr>
<th>
中断
</th>
<th>
功能描述
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
<a href="//www.arduino.cc/reference/en/language/functions/external-interrupts/attachinterrupt/" target="_blank" rel="noopener">attachInterrupt(digitalPinToInterrupt(pin), ISR, mode)</a>
</td>
<td>
用于添加<strong>外部中断</strong>，可用于中断的数字引脚：<strong>Uno</strong> 的<code>2</code>、<code>3</code>号引脚，<strong>Mega2560</strong> 的<code>2</code>、<code>3</code>、<code>18</code>、<code>19</code>、<code>20</code>、<code>21</code>号引脚，以及 <strong>Due</strong> 的所有数字引脚； <br> ▶ 参数<code>interrupt</code>：中断编号，通常使用<code>digitalPinToInterrupt(pin)</code>函数将实际数字引脚转换为特定中断编号，允许的数据类型为<code>int</code>； <br> ▶ 参数<code>pin</code>：发生中断的引脚编号； <br> ▶ 参数<code>ISR</code>：中断服务函数，中断发生时自动调用，该函数必须没有参数与返回值； <br> ▶ 参数<code>mode</code>：<code>LOW</code>：引脚为<strong>低电平</strong>时触发中断；<code>CHANGE</code>：引脚电平发生<strong>变化</strong>时触发中断；<code>RISING</code>：引脚电平由<strong>低电平</strong>变为<strong>高电平</strong>时触发中断；<code>FALLING</code>：引脚电平由<strong>高电平</strong>变为<strong>低电平</strong>时触发中断；此外，Arduino Due、Zero 和 MKR1000 还允许为<code>HIGH</code>，即引脚为<strong>高电平</strong>时触发中断; <br> ▶ 返回值：无； <br> ✸ 中断服务程序（ISR，Interrupt Service Routine）应当尽可能短小快速。如果当前 <strong>Sketch</strong> 设置有多个中断服务，那么每次只能运行 1 个中断，其它中断将会在当前中断执行完成以后，按照优先级顺序进行执行。由<code>millis()</code>依赖于中断进行计数，而<code>delay()</code>需要中断才能生效，因此在中断服务程序内部调用它们将会失效；<code>micros()</code>最初可以正常工作，但是在<code>1 ~ 2</code>毫秒以后发生异常；最后，由于<code>delayMicroseconds()</code>不使用任何计数器，因此将会得到正常运行。 <br> ✸ 通常采用声明为<code>volatile</code>的全局变量在主程序与中断服务程序之间传递数据，从而确保变量在它们之间得到正确的更新；
</td>
</tr>
<tr>
<td>
<a href="//www.arduino.cc/reference/en/language/functions/external-interrupts/detachinterrupt/" target="_blank" rel="noopener">detachInterrupt(digitalPinToInterrupt(pin))</a>
</td>
<td>
关闭指定的<strong>外部中断</strong>。 <br> ▶ 参数<code>interrupt</code>：需要禁用的中断编号； <br> ▶ 参数<code>pin</code>：待禁用外部中断的引脚编号； <br> ▶ 返回值：无；
</td>
</tr>
<tr>
<td>
<a href="//www.arduino.cc/reference/en/language/functions/interrupts/interrupts/" target="_blank" rel="noopener">interrupts()</a>
</td>
<td>
重新使能中断（在<code>nointerrupts()</code>禁用中断之后），中断用于让某些任务运行在后台，其默认情况下是使能的，禁用中断以后会导致一些内置函数无法正常工作。 <br> ▶ 参数：无； <br> ▶ 返回值：无；
</td>
</tr>
<tr>
<td>
<a href="//www.arduino.cc/reference/en/language/functions/interrupts/nointerrupts/" target="_blank" rel="noopener">noInterrupts()</a>
</td>
<td>
禁用中断（可以调用<code>interrupts()</code>重新使能中断），禁用以后会影响到一些内置函数的工作。 <br> ▶ 参数：无； <br> ▶ 返回值：无；
</td>
</tr>
</tbody>
</table>
<h2 id="核心工具类">核心工具类</h2>
<h3 id="serial">Serial</h3>
<p><a href="//www.arduino.cc/reference/en/language/functions/communication/serial/" target="_blank" rel="noopener">Serial 类</a>用于提供<code>UART</code>或者<code>USART</code>串行通信，Arduino 当中串行通信相关的引脚有：<strong>Uno</strong> 的<code>0(RX)、1(TX)</code>引脚；<strong>Mega</strong> 的<code>0(RX)、1(TX)</code>、<code>19(RX)、18(TX)</code>、<code>17(RX)、16(TX)</code>、<code>15(RX)、14(TX)</code>引脚；<strong>Due</strong> 的<code>0(RX)、1(TX)</code>、<code>19(RX)、18(TX)</code>、<code>17(RX)、16(TX)</code>、<code>15(RX)、14(TX)</code>引脚。</p>
<table>
<thead>
<tr>
<th>
串行通信
</th>
<th>
功能描述
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
<a href="//www.arduino.cc/reference/en/language/functions/communication/serial/ifserial" target="_blank" rel="noopener">Serial.if(Serial)</a>
</td>
<td>
判断串行接口是否准备好。
</td>
</tr>
<tr>
<td>
<a href="//www.arduino.cc/reference/en/language/functions/communication/serial/available" target="_blank" rel="noopener">Serial.available()</a>
</td>
<td>
获取当前可以从串口读取的字节数。
</td>
</tr>
<tr>
<td>
<a href="//www.arduino.cc/reference/en/language/functions/communication/serial/availableforwrite" target="_blank" rel="noopener">Serial.availableForWrite()</a>
</td>
<td>
非阻塞写入操作的情况下，获取当前串行缓冲区写入的字节数。
</td>
</tr>
<tr>
<td>
<a href="//www.arduino.cc/reference/en/language/functions/communication/serial/begin" target="_blank" rel="noopener">Serial.begin(speed, config)</a>
</td>
<td>
设置串行数据传输的速率（以<code>比特/秒</code>作为单位）。
</td>
</tr>
<tr>
<td>
<a href="//www.arduino.cc/reference/en/language/functions/communication/serial/end" target="_blank" rel="noopener">Serial.end()</a>
</td>
<td>
禁用串行通信，让<code>RX</code>和<code>TX</code>引脚可以用于普通 I/O，调用<code>Serial.begin()</code>可以重新使能。
</td>
</tr>
<tr>
<td>
<a href="//www.arduino.cc/reference/en/language/functions/communication/serial/find" target="_blank" rel="noopener">Serial.find(target, length)</a>
</td>
<td>
从串行缓冲区读取数据，直至目标被查询到。
</td>
</tr>
<tr>
<td>
<a href="//www.arduino.cc/reference/en/language/functions/communication/serial/finduntil" target="_blank" rel="noopener">Serial.findUntil(target, terminal)</a>
</td>
<td>
从串行缓冲区读取数据，直至查询到给定长度的目标字符串或者终止符字符串。
</td>
</tr>
<tr>
<td>
<a href="//www.arduino.cc/reference/en/language/functions/communication/serial/flush" target="_blank" rel="noopener">Serial.flush()</a>
</td>
<td>
等待输出的串行数据传输完成。
</td>
</tr>
<tr>
<td>
<a href="//www.arduino.cc/reference/en/language/functions/communication/serial/parsefloat" target="_blank" rel="noopener">Serial.parseFloat(lookahead, ignore)</a>
</td>
<td>
从串行缓冲区返回第 1 个有效的浮点数据，如果超时则函数终止
</td>
</tr>
<tr>
<td>
<a href="//www.arduino.cc/reference/en/language/functions/communication/serial/parseint" target="_blank" rel="noopener">Serial.parseInt(lookahead, ignore)</a>
</td>
<td>
从串行输入查找下个有效的整型数据，如果超时则函数终止。
</td>
</tr>
<tr>
<td>
<a href="//www.arduino.cc/reference/en/language/functions/communication/serial/peek" target="_blank" rel="noopener">Serial.peek()</a>
</td>
<td>
返回输入串行数据的下一个字节或字符，而不将其从内部串行缓冲区移除，换而言之，连续调用<code>peek()</code>将会返回相同的字符。
</td>
</tr>
<tr>
<td>
<a href="//www.arduino.cc/reference/en/language/functions/communication/serial/print" target="_blank" rel="noopener">Serial.print(val, format)</a>
</td>
<td>
将数据以 ASCII 文本格式打印至串行端口。
</td>
</tr>
<tr>
<td>
<a href="//www.arduino.cc/reference/en/language/functions/communication/serial/println" target="_blank" rel="noopener">Serial.println(val, format)</a>
</td>
<td>
将数据以 ASCII 文本格式打印至串行端口，后面会添加返回字符（ASCII 码<code>13</code>或者<code>'\r'</code>）和换行字符 （ASCII 码<code>10</code>或者<code>'\n'</code>）。
</td>
</tr>
<tr>
<td>
<a href="//www.arduino.cc/reference/en/language/functions/communication/serial/read" target="_blank" rel="noopener">Serial.read()</a>
</td>
<td>
读取输入的串行数据；
</td>
</tr>
<tr>
<td>
<a href="//www.arduino.cc/reference/en/language/functions/communication/serial/readbytes" target="_blank" rel="noopener">Serial.readBytes(buffer, length)</a>
</td>
<td>
从串行端口读取字符到缓冲区，如果读取完成或者超时则函数终止。
</td>
</tr>
<tr>
<td>
<a href="//www.arduino.cc/reference/en/language/functions/communication/serial/readbytesuntil" target="_blank" rel="noopener">Serial.readBytesUntil(character, buffer, length)</a>
</td>
<td>
将串行缓冲区的字符读取到数组里，如果检测到终止字符或者读取完成以及超时则函数终止。
</td>
</tr>
<tr>
<td>
<a href="//www.arduino.cc/reference/en/language/functions/communication/serial/readstring" target="_blank" rel="noopener">Serial.readString()</a>
</td>
<td>
将串行缓冲区的字符读取到字符串，如果超时则函数中止。
</td>
</tr>
<tr>
<td>
<a href="//www.arduino.cc/reference/en/language/functions/communication/serial/readstringuntil" target="_blank" rel="noopener">Serial.readStringUntil(terminator)</a>
</td>
<td>
将串行缓冲区中的字符读取为字符串，如果检测到终止字符或者超时则函数终止。
</td>
</tr>
<tr>
<td>
<a href="//www.arduino.cc/reference/en/language/functions/communication/serial/settimeout" target="_blank" rel="noopener">Serial.setTimeout(time)</a>
</td>
<td>
设置等待串行数据的最大毫秒数，默认为<code>1000</code>毫秒。
</td>
</tr>
<tr>
<td>
<a href="//www.arduino.cc/reference/en/language/functions/communication/serial/write" target="_blank" rel="noopener">Serial.write(buf, len)</a>
</td>
<td>
向串行接口写入二进制数据。
</td>
</tr>
<tr>
<td>
<a href="//www.arduino.cc/reference/en/language/functions/communication/serial/serialevent" target="_blank" rel="noopener">Serial.serialEvent()</a>
</td>
<td>
当串行数据可用时调用该自定义函数，然后可以使用<code>Serial.read()</code>来捕获这些数据。
</td>
</tr>
</tbody>
</table>
<h3 id="stream">stream</h3>
<p><a href="//www.arduino.cc/reference/en/language/functions/communication/stream/" target="_blank" rel="noopener">stream 类</a> 是基于<strong>字符</strong>和<strong>二进制流</strong>的基类，主要在使用依赖于它的函数时进行调用，比如：<a href="https://www.arduino.cc/reference/en/language/functions/communication/serial/" target="_blank" rel="noopener">Serial</a>、<a href="https://www.arduino.cc/en/Reference/Wire" target="_blank" rel="noopener">Wire</a>、<a href="https://www.arduino.cc/en/Reference/Ethernet" target="_blank" rel="noopener">Ethernet</a>、<a href="https://www.arduino.cc/en/Reference/SD" target="_blank" rel="noopener">SD</a>。</p>
<table>
<thead>
<tr>
<th>
stream 字符与二进制流
</th>
<th>
功能描述
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
<a href="//www.arduino.cc/reference/en/language/functions/communication/stream/streamavailable" target="_blank" rel="noopener">stream.available()</a>
</td>
<td>
获取已经接收到的流当中，可用的字节数。
</td>
</tr>
<tr>
<td>
<a href="//www.arduino.cc/reference/en/language/functions/communication/stream/streamread" target="_blank" rel="noopener">stream.read()</a>
</td>
<td>
将输入流当中的字符读入缓冲区。
</td>
</tr>
<tr>
<td>
<a href="//www.arduino.cc/reference/en/language/functions/communication/stream/streamflush" target="_blank" rel="noopener">stream.flush()</a>
</td>
<td>
所有字符发送完毕以后，清除缓冲区。
</td>
</tr>
<tr>
<td>
<a href="//www.arduino.cc/reference/en/language/functions/communication/stream/streamfind" target="_blank" rel="noopener">stream.find(target, length)</a>
</td>
<td>
从流当中读取数据，直至查询到目标。
</td>
</tr>
<tr>
<td>
<a href="//www.arduino.cc/reference/en/language/functions/communication/stream/streamfinduntil" target="_blank" rel="noopener">stream.findUntil(target, terminal)</a>
</td>
<td>
从流当中读取数据，直至找到给定长度的目标字符串或结束符，或者发生超时为止。
</td>
</tr>
<tr>
<td>
<a href="//www.arduino.cc/reference/en/language/functions/communication/stream/streampeek" target="_blank" rel="noopener">stream.peek()</a>
</td>
<td>
从文件读取 1 个字节而不前进至下个字节，换而言之，连续调用<code>peek()</code>将会返回相同值。
</td>
</tr>
<tr>
<td>
<a href="//www.arduino.cc/reference/en/language/functions/communication/stream/streamreadbytes" target="_blank" rel="noopener">stream.readBytes(buffer, length)</a>
</td>
<td>
从流当中将字符读入缓冲区，当读取完成或者超时就会终止。
</td>
</tr>
<tr>
<td>
<a href="//www.arduino.cc/reference/en/language/functions/communication/stream/streamreadbytesuntil" target="_blank" rel="noopener">stream.readBytesUntil(character, buffer, length)</a>
</td>
<td>
从流中读取字符到缓冲区，如果检测到终止符字符，或者读取完成以及超时的时候，就会终止。
</td>
</tr>
<tr>
<td>
<a href="//www.arduino.cc/reference/en/language/functions/communication/stream/streamreadstring" target="_blank" rel="noopener">stream.readString()</a>
</td>
<td>
从流中读取字符到字符串，如果超时则函数终止。
</td>
</tr>
<tr>
<td>
<a href="//www.arduino.cc/reference/en/language/functions/communication/stream/streamreadstringuntil" target="_blank" rel="noopener">stream.readStringUntil(terminator)</a>
</td>
<td>
从流中读取字符到字符串，如果检测到终止符或者超时则函数终止。
</td>
</tr>
<tr>
<td>
<a href="//www.arduino.cc/reference/en/language/functions/communication/stream/streamparseint" target="_blank" rel="noopener">stream.parseInt(lookahead, ignore)</a>
</td>
<td>
返回当前位置的第 1 个有效的整型数据；
</td>
</tr>
<tr>
<td>
<a href="//www.arduino.cc/reference/en/language/functions/communication/stream/streamparsefloat" target="_blank" rel="noopener">stream.parseFloat(lookahead, ignore)</a>
</td>
<td>
返回当前位置的第 1 个有效的浮点型数据；
</td>
</tr>
<tr>
<td>
<a href="//www.arduino.cc/reference/en/language/functions/communication/stream/streamsettimeout" target="_blank" rel="noopener">stream.setTimeout(time)</a>
</td>
<td>
设置等待流数据的最大毫秒数，默认为<code>1000</code>毫秒。该函数为<code>Stream</code>类的一部分，并且可以从继承该类的<code>Wire</code>、<code>Serial</code>等类上进行调用。
</td>
</tr>
</tbody>
</table>
<h3 id="mouse">Mouse</h3>
<p><a href="//www.arduino.cc/reference/en/language/functions/usb/mouse/" target="_blank" rel="noopener">Mouse 类</a>可以让基于<code>32u4</code>或<code>SAMD</code>微控制器的开发板（Leonardo、Esplora、Zero、Due、MKR）通过其 Micro USB 接口控制其所连接计算机上的鼠标。</p>
<table>
<thead>
<tr>
<th>
Mouse 鼠标控制
</th>
<th>
功能描述
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
<a href="//www.arduino.cc/reference/en/language/functions/usb/mouse/mousebegin" target="_blank" rel="noopener">Mouse.begin()</a>
</td>
<td>
用于模拟连接到计算机的鼠标，结束控制可以调用<code>Mouse.end()</code>。
</td>
</tr>
<tr>
<td>
<a href="//www.arduino.cc/reference/en/language/functions/usb/mouse/mouseclick" target="_blank" rel="noopener">Mouse.click(button)</a>
</td>
<td>
在当前鼠标所在的位置向计算机发送瞬时单击，作用与按下并立即释放鼠标按键相同。
</td>
</tr>
<tr>
<td>
<a href="//www.arduino.cc/reference/en/language/functions/usb/mouse/mouseend" target="_blank" rel="noopener">Mouse.end()</a>
</td>
<td>
用于停止模拟连接至计算机的鼠标。
</td>
</tr>
<tr>
<td>
<a href="//www.arduino.cc/reference/en/language/functions/usb/mouse/mousemove" target="_blank" rel="noopener">Mouse.move(xVal, yVal, wheel)</a>
</td>
<td>
移动当前连接计算机上的鼠标位置，屏幕上的运动始终相对于光标当前的位置，使用之前必须首先调用<code>Mouse.begin()</code>。
</td>
</tr>
<tr>
<td>
<a href="//www.arduino.cc/reference/en/language/functions/usb/mouse/mousepress" target="_blank" rel="noopener">Mouse.press(button)</a>
</td>
<td>
将按下鼠标按键的操作发送至当前连接的计算机，类似于单击并且连续按住鼠标按键，可以调用<code>Mouse.release()</code>取消该操作。
</td>
</tr>
<tr>
<td>
<a href="//www.arduino.cc/reference/en/language/functions/usb/mouse/mouserelease" target="_blank" rel="noopener">Mouse.release(button)</a>
</td>
<td>
松开之前按下的鼠标按键。
</td>
</tr>
<tr>
<td>
<a href="//www.arduino.cc/reference/en/language/functions/usb/mouse/mouseispressed" target="_blank" rel="noopener">Mouse.isPressed(button)</a>
</td>
<td>
检查当前指定鼠标按键的状态。
</td>
</tr>
</tbody>
</table>
<h3 id="keyboard">Keyboard</h3>
<p><a href="//www.arduino.cc/reference/en/language/functions/usb/keyboard/" target="_blank" rel="noopener">Keyboard 类</a>可以让基于<code>32u4</code>或<code>SAMD</code>微控制器的开发板（Leonardo、Esplora、Zero、Due、MKR）通过 Micro USB 控制其所连接计算机上的键盘。</p>
<table>
<thead>
<tr>
<th>
Keyboard 键盘控制
</th>
<th>
功能描述
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
<a href="//www.arduino.cc/reference/en/language/functions/usb/keyboard/keyboardbegin" target="_blank" rel="noopener">Keyboard.begin()</a>
</td>
<td>
使用 Due 开发板时，表示开始模拟连接到计算机的键盘，调用<code>Keyboard.end()</code>可以结束控制。
</td>
</tr>
<tr>
<td>
<a href="//www.arduino.cc/reference/en/language/functions/usb/keyboard/keyboardend" target="_blank" rel="noopener">Keyboard.end()</a>
</td>
<td>
停止 Arduino 对当前连接计算机的键盘的仿真。
</td>
</tr>
<tr>
<td>
<a href="//www.arduino.cc/reference/en/language/functions/usb/keyboard/keyboardpress" target="_blank" rel="noopener">Keyboard.press(key)</a>
</td>
<td>
模拟按下并且按住键盘的操作，主要用于组合按键，可以调用<code>Keyboard.release</code>或者<code>Keyboard.releaseAll</code>结束操作，使用前必须首先调用<code>Keyboard.begin()</code>。
</td>
</tr>
<tr>
<td>
<a href="//www.arduino.cc/reference/en/language/functions/usb/keyboard/keyboardprint" target="_blank" rel="noopener">Keyboard.print(characters)</a>
</td>
<td>
将击键操作发送至当前连接的计算机。
</td>
</tr>
<tr>
<td>
<a href="//www.arduino.cc/reference/en/language/functions/usb/keyboard/keyboardprintln" target="_blank" rel="noopener">Keyboard.println(characters)</a>
</td>
<td>
将击键操作发送至当前连接的计算机，然后发送换行符和回车符。
</td>
</tr>
<tr>
<td>
<a href="//www.arduino.cc/reference/en/language/functions/usb/keyboard/keyboardrelease" target="_blank" rel="noopener">Keyboard.release(key)</a>
</td>
<td>
松开指定的键盘按键。
</td>
</tr>
<tr>
<td>
<a href="//www.arduino.cc/reference/en/language/functions/usb/keyboard/keyboardreleaseall" target="_blank" rel="noopener">Keyboard.releaseAll()</a>
</td>
<td>
松开当前按下的所有按键。
</td>
</tr>
<tr>
<td>
<a href="//www.arduino.cc/reference/en/language/functions/usb/keyboard/keyboardwrite" target="_blank" rel="noopener">Keyboard.write(character)</a>
</td>
<td>
模拟按下并且释放键盘上的按键，可以直接用于发送 ASCII 字符或者其它的修饰符以及特殊按键。
</td>
</tr>
</tbody>
</table>
<h2 id="安装第三方类库">安装第三方类库</h2>
<p>Arduino 提供了大量由工程师或者爱好者编写的<a href="https://www.arduino.cc/en/Reference/Libraries" target="_blank" rel="noopener">第三方库</a>，选择 Arduino IDE 菜单栏上的<code>【项目 &gt; 加载库 &gt; 管理库...】</code>或是按下【Ctrl + Shift + I】快捷键：</p>
<p><img src="/Embedded/Arduino/Update/0.png"></p>
<p>打开<code>【库管理器】</code>界面，搜索并且选择指定的第三库点击<code>【安装】</code>按钮即可：</p>
<p><img src="/Embedded/Arduino/Update/1.png"></p>
<p>此外，还可以离线直接安装<code>ZIP</code>格式的第三方库，压缩包的名称即为库的名称，压缩包当中包含 1 份<code>.cpp</code>源文件和 1 份<code>.h</code>头文件，以及一些其它的相关文件。此时选择菜单栏上的<code>【项目 &gt; 加载库 &gt; 添加.zip库...】</code>，然后在弹出的对话框中选择<code>.zip</code>文件即可完成安装：</p>
<p><img src="/Embedded/Arduino/Update/2.png"></p>
<h2 id="添加板级支持包">添加板级支持包</h2>
<p>自从 Arduino IDE 1.6.2 版本开始，默认会安装所有 AVR 微控制器的核心板级支持包。但是某些第三方厂商生产的 Arduino 开发板需要额外进行安装，此时可以选择菜单栏上的【工具 &gt; 开发板 &gt; 开发板管理器...】：</p>
<p><img src="/Embedded/Arduino/Update/3.png"></p>
<p>打开【开发板管理器】界面以后，检索需要的板级支持包名称就可以进行添加操作：</p>
<p><img src="/Embedded/Arduino/Update/4.png"></p>
<p>如果第三方厂商的开发板不在 Arduino 官方的支持列表里面，则再需要选择菜单栏上的<code>【文件 &gt; 首选项 &gt; 附加开发板管理器网址】</code>，然后输入一个指向 JSON 格式配置文件的 URL 地址（如果存在多个可以用逗号<code>,</code>进行分隔），再重新进入<code>【开发板管理器】</code>更新安装所需的支持包即可。</p>
<p><img src="/Embedded/Arduino/Update/5.png"></p>
<h2 id="wemos-d1">Wemos D1</h2>
<p><a href="https://www.wemos.cc/" target="_blank" rel="noopener">Wemos D1</a>是一款基于上海乐鑫科技的 <strong>WIFI</strong> 芯片 <a href="https://www.espressif.com/zh-hans/products/hardware/esp8266ex/overview" target="_blank" rel="noopener">ESP8266</a> 的仿 <strong>Arduino Uno</strong> 开发板，通过<a href="https://github.com/esp8266/Arduino" target="_blank" rel="noopener">Arduino core for ESP8266 WiFi chip 开源项目</a>为 Arduino 环境提供了对 ESP8266 芯片的支持，打开 Arduino IDE 的首选项，在<code>【文件 &gt; 首选项 &gt; 附加开发板管理器网址】</code>添加下面的 URL 地址，如果已经存在多个 URL，那么可以使用逗号<code>,</code>进行分隔。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https://arduino.esp8266.com/stable/package_esp8266com_index.json</span><br></pre></td></tr></table></figure>
<p><img src="/Embedded/Arduino/ESP8266/1.png"></p>
<p>然后，选择菜单栏的<code>【工具 &gt; 开发板 &gt; 开发板管理器...】</code>打开<strong>开发板管理器</strong>，安装<code>esp8266</code>平台支持库：</p>
<p><img src="/Embedded/Arduino/ESP8266/2.png"></p>
<p>最后，不要忘记到菜单栏上面，重新选择<code>【工具 &gt; 开发板 &gt; WeMos D1 R1】</code>开发板型号：</p>
<p><img src="/Embedded/Arduino/ESP8266/3.png"></p>
<p>选择完成以后，Arduino IDE 的<code>【工具】</code>菜单栏下面会展示 ESP8266 支持包提供的一些配置选项，关于 ESP8266 以及 Wemos D1 的具体使用方式请查阅<a href="https://arduino-esp8266.readthedocs.io/en/latest/" target="_blank" rel="noopener">《Arduino core for ESP8266 WiFi chip》使用文档</a>，此处不做赘述。</p>
<p><img src="/Embedded/Arduino/ESP8266/4.png"></p>
<h2 id="mega-2560">Mega 2560</h2>
<p><a href="https://store.arduino.cc/usa/mega-2560-r3" target="_blank" rel="noopener">Arduino Mega 2560</a>开发板基于<a href="http://ww1.microchip.com/downloads/en/DeviceDoc/Atmel-2549-8-bit-AVR-Microcontroller-ATmega640-1280-1281-2560-2561_datasheet.pdf" target="_blank" rel="noopener">ATmega2560</a>微控制器，与 Uno 上采用的 ATmega328P 同属 8 位 AVR 微控制器，其工作电压同为<code>5V</code>，采用的时钟频率为<code>16MHz</code>，拥有<code>256KB</code>容量的 Flash 存储器（其中<code>8KB</code>用于 Bootloader），<code>8KB</code>大小的 SRAM，<code>4KB</code>容量的 EEPROM。</p>
<p><img src="/Embedded/Arduino/Mega/0.jpg"></p>
<p>板载 54 个数字输入/输出引脚（其中 15 个可用作 PWM 输出），16 个模拟输入引脚，4 个 UART（硬件串行端口）。推荐的输入电压在<code>7 ~ 12V</code>范围以内，而极限输入电压则在<code>6 ~ 20V</code>之间，每个 I/O 引脚可以输出<code>20mA</code>直流电流，其中<code>3.3V</code>引脚可以输出<code>50mA</code>直流电流。</p>
<p><img src="/Embedded/Arduino/Mega/1.png"></p>
<p><img src="/Embedded/Arduino/Mega/2.png"></p>
<p><img src="/Embedded/Arduino/Mega/3.png"></p>
<p><img src="/Embedded/Arduino/Mega/4.png"></p>
<h2 id="due">Due</h2>
<p><a href="https://store.arduino.cc/usa/due" target="_blank" rel="noopener">Arduino Due</a> 开发板基于 <a href="http://www.atmel.com/Images/Atmel-11057-32-bit-Cortex-M3-Microcontroller-SAM3X-SAM3A_Datasheet.pdf" target="_blank" rel="noopener">Atmel SAM3X8E ARM Cortex-M3 CPU</a> 微控制器，工作电压为<code>3.3V</code>，采用的时钟晶振频率为<code>84 MHz</code>，拥有<code>512KB</code>的 Flash 存储器，以及<code>96KB</code>的 SRAM（分为<code>64KB</code>和<code>32KB</code>两个<strong>Bank</strong>）。作为第一款基于 32 位 ARM 内核微控制器的 Arduino 开发板，板载 54 个数字输入/输出引脚（其中 12 个可用于 PWM 输出），12 个模拟输出，4 个硬件串行接口，其引脚分布基本与 Arduino Mega 2560 保持一致。</p>
<p><img src="/Embedded/Arduino/Due/1.jpg"></p>

    </div>

    
    
    
        

<div>
<ul class="post-copyright">
  <li class="post-copyright-author">
    <strong>本文作者： </strong>Hank
  </li>
  <li class="post-copyright-link">
    <strong>本文链接：</strong>
    <a href="https://uinika.github.io/Embedded/Arduino.html" title="玩转 Arduino Uno、Mega、Due 开源硬件">https://uinika.github.io/Embedded/Arduino.html</a>
  </li>
  <li class="post-copyright-license">
    <strong>版权声明： </strong>本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh" rel="noopener" target="_blank"><i class="fa fa-fw fa-creative-commons"></i>BY-NC-SA</a> 许可协议。转载请注明出处！
  </li>
</ul>
</div>


      <footer class="post-footer">
          
          <div class="post-tags">
              <a href="/tags/MCU/" rel="tag"><i class="fa fa-tag"></i> MCU</a>
          </div>

        


        
    <div class="post-nav">
      <div class="post-nav-item">
    <a href="/Electronics/KiCad.html" rel="prev" title="开源 EDA 工具 KiCad 5.1.5 电路设计手册">
      <i class="fa fa-chevron-left"></i> 开源 EDA 工具 KiCad 5.1.5 电路设计手册
    </a></div>
      <div class="post-nav-item">
    <a href="/Embedded/JLink.html" rel="next" title="J-Link 仿真器固件恢复小记">
      J-Link 仿真器固件恢复小记 <i class="fa fa-chevron-right"></i>
    </a></div>
    </div>
      </footer>
    
  </article>
  
  
  



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
          <div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#安装驱动程序"><span class="nav-number">1.</span> <span class="nav-text">安装驱动程序</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#arduino-ide"><span class="nav-number">2.</span> <span class="nav-text">Arduino IDE</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#avr-存储空间"><span class="nav-number">3.</span> <span class="nav-text">AVR 存储空间</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#引脚资源"><span class="nav-number">4.</span> <span class="nav-text">引脚资源</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#数字引脚-digital"><span class="nav-number">4.1.</span> <span class="nav-text">数字引脚 Digital</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#input-输入"><span class="nav-number">4.1.1.</span> <span class="nav-text">INPUT 输入</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#input_pullup-上拉输入"><span class="nav-number">4.1.2.</span> <span class="nav-text">INPUT_PULLUP 上拉输入</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#output-输出"><span class="nav-number">4.1.3.</span> <span class="nav-text">OUTPUT 输出</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#模拟引脚-analog"><span class="nav-number">4.2.</span> <span class="nav-text">模拟引脚 Analog</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#脉冲宽度调制-pwm"><span class="nav-number">4.3.</span> <span class="nav-text">脉冲宽度调制 PWM</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#arduino-c"><span class="nav-number">5.</span> <span class="nav-text">Arduino C++</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#常量"><span class="nav-number">5.1.</span> <span class="nav-text">常量</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#整型常量"><span class="nav-number">5.1.1.</span> <span class="nav-text">整型常量</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#浮点常量"><span class="nav-number">5.1.2.</span> <span class="nav-text">浮点常量</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#布尔常量-true-与-false"><span class="nav-number">5.1.3.</span> <span class="nav-text">布尔常量 true 与 false</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#电平状态-high-low"><span class="nav-number">5.1.4.</span> <span class="nav-text">电平状态 HIGH LOW</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#输入状态-input-output-input_pullup"><span class="nav-number">5.1.5.</span> <span class="nav-text">输入状态 INPUT OUTPUT INPUT_PULLUP</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#板载-led_builtin"><span class="nav-number">5.1.6.</span> <span class="nav-text">板载 LED_BUILTIN</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#数据类型"><span class="nav-number">5.2.</span> <span class="nav-text">数据类型</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#变量限定符"><span class="nav-number">5.3.</span> <span class="nav-text">变量限定符</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#const"><span class="nav-number">5.3.1.</span> <span class="nav-text">const</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#static"><span class="nav-number">5.3.2.</span> <span class="nav-text">static</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#volatile"><span class="nav-number">5.3.3.</span> <span class="nav-text">volatile</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#progmem"><span class="nav-number">5.3.4.</span> <span class="nav-text">PROGMEM</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#数组处理"><span class="nav-number">5.4.</span> <span class="nav-text">数组处理</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#核心工具函数"><span class="nav-number">6.</span> <span class="nav-text">核心工具函数</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#数字-io"><span class="nav-number">6.1.</span> <span class="nav-text">数字 I&#x2F;O</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#模拟-io"><span class="nav-number">6.2.</span> <span class="nav-text">模拟 I&#x2F;O</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#高级-io"><span class="nav-number">6.3.</span> <span class="nav-text">高级 I&#x2F;O</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#zeroduemkr-专属-io"><span class="nav-number">6.4.</span> <span class="nav-text">Zero、Due、MKR 专属 I&#x2F;O</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#定时"><span class="nav-number">6.5.</span> <span class="nav-text">定时</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#数学"><span class="nav-number">6.6.</span> <span class="nav-text">数学</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#字符"><span class="nav-number">6.7.</span> <span class="nav-text">字符</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#位操作"><span class="nav-number">6.8.</span> <span class="nav-text">位操作</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#中断"><span class="nav-number">6.9.</span> <span class="nav-text">中断</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#核心工具类"><span class="nav-number">7.</span> <span class="nav-text">核心工具类</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#serial"><span class="nav-number">7.1.</span> <span class="nav-text">Serial</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#stream"><span class="nav-number">7.2.</span> <span class="nav-text">stream</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#mouse"><span class="nav-number">7.3.</span> <span class="nav-text">Mouse</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#keyboard"><span class="nav-number">7.4.</span> <span class="nav-text">Keyboard</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#安装第三方类库"><span class="nav-number">8.</span> <span class="nav-text">安装第三方类库</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#添加板级支持包"><span class="nav-number">9.</span> <span class="nav-text">添加板级支持包</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#wemos-d1"><span class="nav-number">10.</span> <span class="nav-text">Wemos D1</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#mega-2560"><span class="nav-number">11.</span> <span class="nav-text">Mega 2560</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#due"><span class="nav-number">12.</span> <span class="nav-text">Due</span></a></li></ol></div>
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="Hank"
      src="/images/avatar.png">
  <p class="site-author-name" itemprop="name">Hank</p>
  <div class="site-description" itemprop="description">My world of IT, learn it & play it.</div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">53</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
          
        <span class="site-state-item-count">11</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
          
        <span class="site-state-item-count">22</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author motion-element">
      <span class="links-of-author-item">
        <a href="https://github.com/uinika" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;uinika" rel="noopener" target="_blank"><i class="fa fa-fw fa-github-alt"></i>GitHub</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://www.zhihu.com/people/uinika/posts" title="知乎 → https:&#x2F;&#x2F;www.zhihu.com&#x2F;people&#x2F;uinika&#x2F;posts" rel="noopener" target="_blank"><i class="fa fa-fw fa-quora"></i>知乎</a>
      </span>
      <span class="links-of-author-item">
        <a href="mailto:uinika@outlook.com" title="Email → mailto:uinika@outlook.com" rel="noopener" target="_blank"><i class="fa fa-fw fa-envelope"></i>Email</a>
      </span>
      <span class="links-of-author-item">
        <a href="skype:uinika@outlook.com?call|chat" title="Skype → skype:uinika@outlook.com?call|chat" rel="noopener" target="_blank"><i class="fa fa-fw fa-skype"></i>Skype</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://stackoverflow.com/users/7998979/uinika?tab=profile" title="Stack Overflow → https:&#x2F;&#x2F;stackoverflow.com&#x2F;users&#x2F;7998979&#x2F;uinika?tab&#x3D;profile" rel="noopener" target="_blank"><i class="fa fa-fw fa-stack-overflow"></i>Stack Overflow</a>
      </span>
  </div>
  <div class="cc-license motion-element" itemprop="license">
    <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh" class="cc-opacity" rel="noopener" target="_blank"><img src="/images/cc-by-nc-sa.svg" alt="Creative Commons"></a>
  </div>



      </div>
        <div class="back-to-top motion-element">
          <i class="fa fa-arrow-up"></i>
          <span>0%</span>
        </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 2010 – 
  <span itemprop="copyrightYear">2020</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder"><a rel="license noopener" href="http://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">知识共享署名-非商业性使用-相同方式共享 4.0 国际许可协议</a></span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-area-chart"></i>
    </span>
      <span class="post-meta-item-text">站点总字数：</span>
    <span title="站点总字数">1.6m</span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-coffee"></i>
    </span>
      <span class="post-meta-item-text">站点阅读时长 &asymp;</span>
    <span title="站点阅读时长">23:45</span>
</div>

        
<div class="busuanzi-count">
  <script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
    <span class="post-meta-item" id="busuanzi_container_site_uv" style="display: none;">
      <span class="post-meta-item-icon">
        <i class="fa fa-user"></i>
      </span>
      <span class="site-uv" title="总访客量">
        <span id="busuanzi_value_site_uv"></span>
      </span>
    </span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item" id="busuanzi_container_site_pv" style="display: none;">
      <span class="post-meta-item-icon">
        <i class="fa fa-eye"></i>
      </span>
      <span class="site-pv" title="总访问量">
        <span id="busuanzi_value_site_pv"></span>
      </span>
    </span>
</div>








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/pisces.js"></script>


<script src="/js/next-boot.js"></script>

<script src="/js/bookmark.js"></script>




  




  
<script src="/js/local-search.js"></script>













  

  
      

<script>
  if (typeof MathJax === 'undefined') {
    window.MathJax = {
      loader: {
        source: {
          '[tex]/amsCd': '[tex]/amscd',
          '[tex]/AMScd': '[tex]/amscd'
        }
      },
      tex: {
        inlineMath: {'[+]': [['$', '$']]},
        tags: 'ams'
      },
      options: {
        renderActions: {
          findScript: [10, doc => {
            document.querySelectorAll('script[type^="math/tex"]').forEach(node => {
              const display = !!node.type.match(/; *mode=display/);
              const math = new doc.options.MathItem(node.textContent, doc.inputJax[0], display);
              const text = document.createTextNode('');
              node.parentNode.replaceChild(text, node);
              math.start = {node: text, delim: '', n: 0};
              math.end = {node: text, delim: '', n: 0};
              doc.math.push(math);
            });
          }, '', false],
          insertedScript: [200, () => {
            document.querySelectorAll('mjx-container').forEach(node => {
              let target = node.parentNode;
              if (target.nodeName.toLowerCase() === 'li') {
                target.parentNode.classList.add('has-jax');
              }
            });
          }, '', false]
        }
      }
    };
    (function () {
      var script = document.createElement('script');
      script.src = '//cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js';
      script.defer = true;
      document.head.appendChild(script);
    })();
  } else {
    MathJax.startup.document.state(0);
    MathJax.texReset();
    MathJax.typeset();
  }
</script>

    

  

</body>
</html>
